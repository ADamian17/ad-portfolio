/*! For license information please see app.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)};function n(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function o(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=h(t[n],e[n]));return t}var l=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){try{return"[object process]"===Object.prototype.toString.call(t.g.process)}catch(t){return!1}}var d=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,y.prototype.create),o}return n(e,t),e}(Error),y=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?v(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new d(i,a,r);return u},t}();function v(t,e){return t.replace(m,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var m=/\{\$([^}]+)}/g;function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function b(t,e){var n=new w(t,e);return n.subscribe.bind(n)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782),i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295,l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();var w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=I),void 0===r.error&&(r.error=I),void 0===r.complete&&(r.complete=I);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function I(){}function _(t){return t&&t._delegate?t._delegate:t}var E,T=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),S="[DEFAULT]",A=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return t.prototype.get=function(t){void 0===t&&(t=S);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new l;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r({identifier:S,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(o)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:o})}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:S})}catch(t){}try{for(var r=s(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=a(i.value,2),u=o[0],c=o[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService({instanceIdentifier:h});c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=S),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(u(u([],a(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),a(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=S),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.instanceIdentifier,i=void 0===r?S:r,o=t.options,u=void 0===o?{}:o,c=this.normalizeInstanceIdentifier(i);if(this.isInitialized(c))throw Error(this.name+"("+c+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var h=this.getOrInitializeService({instanceIdentifier:c,options:u});try{for(var l=s(this.instancesDeferred.entries()),f=l.next();!f.done;f=l.next()){var p=a(f.value,2),d=p[0],y=p[1];c===this.normalizeInstanceIdentifier(d)&&y.resolve(h)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(h,c),h},t.prototype.onInit=function(t){var e=this;return this.onInitCallbacks.add(t),function(){e.onInitCallbacks.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r;try{for(var i=s(this.onInitCallbacks),o=i.next();!o.done;o=i.next()){var a=o.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===S?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:S:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),N=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new A(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function D(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var C,k=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(C||(C={}));var R,x={debug:C.DEBUG,verbose:C.VERBOSE,info:C.INFO,warn:C.WARN,error:C.ERROR,silent:C.SILENT},O=C.INFO,L=((E={})[C.DEBUG]="log",E[C.VERBOSE]="log",E[C.INFO]="info",E[C.WARN]="warn",E[C.ERROR]="error",E),P=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=L[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,D(["["+i+"]  "+t.name+":"],n))}},M=function(){function t(t){this.name=t,this._logLevel=O,this._logHandler=P,this._userLogHandler=null,k.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in C))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?x[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,D([this,C.DEBUG],t)),this._logHandler.apply(this,D([this,C.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,D([this,C.VERBOSE],t)),this._logHandler.apply(this,D([this,C.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,D([this,C.INFO],t)),this._logHandler.apply(this,D([this,C.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,D([this,C.WARN],t)),this._logHandler.apply(this,D([this,C.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,D([this,C.ERROR],t)),this._logHandler.apply(this,D([this,C.ERROR],t))},t}();function F(t){k.forEach((function(e){e.setLogLevel(t)}))}var V,U=((R={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",R["bad-app-name"]="Illegal App name: '{$appName}",R["duplicate-app"]="Firebase App named '{$appName}' already exists",R["app-deleted"]="Firebase App named '{$appName}' already deleted",R["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",R["invalid-log-argument"]="First argument to `onLog` must be null or a function.",R),q=new y("app","Firebase",U),B="@firebase/app",j="[DEFAULT]",K=((V={})[B]="fire-core",V["@firebase/analytics"]="fire-analytics",V["@firebase/app-check"]="fire-app-check",V["@firebase/auth"]="fire-auth",V["@firebase/database"]="fire-rtdb",V["@firebase/functions"]="fire-fn",V["@firebase/installations"]="fire-iid",V["@firebase/messaging"]="fire-fcm",V["@firebase/performance"]="fire-perf",V["@firebase/remote-config"]="fire-rc",V["@firebase/storage"]="fire-gcs",V["@firebase/firestore"]="fire-fst",V["fire-js"]="fire-js",V["firebase-wrapper"]="fire-js-all",V),G=new M("@firebase/app"),z=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=h(void 0,t),this.container=new N(e.name),this._addComponent(new T("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=j),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=j),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){G.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw q.create("app-deleted",{appName:this.name_})},t}();z.prototype.name&&z.prototype.options||z.prototype.delete||console.log("dc");var H=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=j);var s=o.name;if("string"!=typeof s||!s)throw q.create("bad-app-name",{appName:String(s)});if(g(e,s))throw q.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=K[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void G.warn(u.join(" "))}o(new T(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:F,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw q.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=x[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:C[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=k;r<i.length;r++)n(i[r])}(t,e)},apps:null,SDK_VERSION:"8.6.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!g(e,t=t||j))throw q.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return G.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw q.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&h(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(z);return e.INTERNAL=r(r({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){h(e,t)},createSubscribe:b,ErrorFactory:y,deepExtend:h}),e}(),Q=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){G.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var W=self.firebase.SDK_VERSION;W&&W.indexOf("LITE")>=0&&G.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Y=H.initializeApp;H.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return p()&&G.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Y.apply(void 0,t)};var X=H;!function(t,e){t.INTERNAL.registerComponent(new T("platform-logger",(function(t){return new Q(t)}),"PRIVATE")),t.registerVersion(B,"0.6.22",void 0),t.registerVersion("fire-js","")}(X);const J=X;J.registerVersion("firebase","8.6.3","app");var Z=function(t,e){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function tt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var et,nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},rt=rt||{},it=nt||self;function ot(){}function st(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function at(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ut="closure_uid_"+(1e9*Math.random()>>>0),ct=0;function ht(t,e,n){return t.call.apply(t.bind,arguments)}function lt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ft(t,e,n){return(ft=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ht:lt).apply(null,arguments)}function pt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function dt(){return Date.now()}function yt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function vt(){this.j=this.j,this.i=this.i}vt.prototype.j=!1,vt.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ut)&&t[ut]||(t[ut]=++ct)}(this)},vt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var mt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},gt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function bt(t){return Array.prototype.concat.apply([],arguments)}function wt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function It(t){return/^[\s\xa0]*$/.test(t)}var _t,Et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Tt(t,e){return-1!=t.indexOf(e)}function St(t,e){return t<e?-1:t>e?1:0}t:{var At=it.navigator;if(At){var Nt=At.userAgent;if(Nt){_t=Nt;break t}}_t=""}function Dt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ct(t){var e={};for(var n in t)e[n]=t[n];return e}var kt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<kt.length;o++)n=kt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function xt(t){return xt[" "](t),t}xt[" "]=ot;var Ot,Lt,Pt=Tt(_t,"Opera"),Mt=Tt(_t,"Trident")||Tt(_t,"MSIE"),Ft=Tt(_t,"Edge"),Vt=Ft||Mt,Ut=Tt(_t,"Gecko")&&!(Tt(_t.toLowerCase(),"webkit")&&!Tt(_t,"Edge"))&&!(Tt(_t,"Trident")||Tt(_t,"MSIE"))&&!Tt(_t,"Edge"),qt=Tt(_t.toLowerCase(),"webkit")&&!Tt(_t,"Edge");function Bt(){var t=it.document;return t?t.documentMode:void 0}t:{var jt="",Kt=(Lt=_t,Ut?/rv:([^\);]+)(\)|;)/.exec(Lt):Ft?/Edge\/([\d\.]+)/.exec(Lt):Mt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Lt):qt?/WebKit\/(\S+)/.exec(Lt):Pt?/(?:Version)[ \/]?(\S+)/.exec(Lt):void 0);if(Kt&&(jt=Kt?Kt[1]:""),Mt){var Gt=Bt();if(null!=Gt&&Gt>parseFloat(jt)){Ot=String(Gt);break t}}Ot=jt}var zt,Ht={};function Qt(t){return function(t,e){var n=Ht;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=Et(String(Ot)).split("."),r=Et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=St(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||St(0==s[2].length,0==a[2].length)||St(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}it.document&&Mt?zt=Bt()||parseInt(Ot,10)||void 0:zt=void 0;var Wt=zt,Yt=!Mt||9<=Number(Wt),$t=Mt&&!Qt("9"),Xt=function(){if(!it.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{it.addEventListener("test",ot,e),it.removeEventListener("test",ot,e)}catch(t){}return t}();function Jt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Zt(t,e){if(Jt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Ut){t:{try{xt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:te[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Jt.prototype.b=function(){this.defaultPrevented=!0},yt(Zt,Jt);var te={2:"touch",3:"pen",4:"mouse"};Zt.prototype.b=function(){Zt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$t)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ee="closure_listenable_"+(1e6*Math.random()|0),ne=0;function re(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ne,this.Y=this.Z=!1}function ie(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function oe(t){this.src=t,this.a={},this.b=0}function se(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=mt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ie(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ae(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}oe.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ae(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new re(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var ue="closure_lm_"+(1e6*Math.random()|0),ce={};function he(t,e,n,r,i){if(r&&r.once)return fe(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)he(t,e[o],n,r,i);return null}return n=we(n),t&&t[ee]?t.va(e,n,at(r)?!!r.capture:!!r,i):le(t,e,n,!1,r,i)}function le(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=at(i)?!!i.capture:!!i;if(s&&!Yt)return null;var a=ge(t);if(a||(t[ue]=a=new oe(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=me,e=Yt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Xt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ye(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function fe(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)fe(t,e[o],n,r,i);return null}return n=we(n),t&&t[ee]?t.wa(e,n,at(r)?!!r.capture:!!r,i):le(t,e,n,!0,r,i)}function pe(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pe(t,e[o],n,r,i);else r=at(r)?!!r.capture:!!r,n=we(n),t&&t[ee]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=ae(o=t.a[e],n,r,i))&&(ie(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ge(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ae(e,n,r,i)),(n=-1<t?e[t]:null)&&de(n))}function de(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ee])se(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ye(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ge(e))?(se(n,t),0==n.b&&(n.src=null,e[ue]=null)):ie(t)}}}function ye(t){return t in ce?ce[t]:ce[t]="on"+t}function ve(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&de(t),n.call(r,e)}function me(t,e){if(t.Y)return!0;if(!Yt){if(!e)t:{e=["window","event"];for(var n=it,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return ve(t,e=new Zt(e,this))}return ve(t,new Zt(e,this))}function ge(t){return(t=t[ue])instanceof oe?t:null}var be="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(t){return"function"==typeof t?t:(t[be]||(t[be]=function(e){return t.handleEvent(e)}),t[be])}function Ie(){vt.call(this),this.c=new oe(this),this.J=this,this.C=null}function _e(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Jt(e,t);else if(e instanceof Jt)e.target=e.target||t;else{var i=e;Rt(e=new Jt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Ee(s,r,!0,e)&&i}if(i=Ee(s=e.a=t,r,!0,e)&&i,i=Ee(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ee(s=e.a=n[o],r,!1,e)&&i}function Ee(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&se(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}yt(Ie,vt),Ie.prototype[ee]=!0,(et=Ie.prototype).addEventListener=function(t,e,n,r){he(this,t,e,n,r)},et.removeEventListener=function(t,e,n,r){pe(this,t,e,n,r)},et.G=function(){if(Ie.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ie(n[r]);delete e.a[t],e.b--}}this.C=null},et.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},et.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Te=it.JSON.stringify;function Se(){this.b=this.a=null}var Ae,Ne=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ce}),(function(t){t.reset()}));function De(){var t=Oe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ce(){this.next=this.b=this.a=null}function ke(t){it.setTimeout((function(){throw t}),0)}function Re(t,e){Ae||function(){var t=it.Promise.resolve(void 0);Ae=function(){t.then(Le)}}(),xe||(Ae(),xe=!0),Oe.add(t,e)}Se.prototype.add=function(t,e){var n=Ne.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ce.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ce.prototype.reset=function(){this.next=this.b=this.a=null};var xe=!1,Oe=new Se;function Le(){for(var t;t=De();){try{t.a.call(t.b)}catch(t){ke(t)}var e=Ne;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}xe=!1}function Pe(t,e){Ie.call(this),this.b=t||1,this.a=e||it,this.f=ft(this.Za,this),this.g=dt()}function Me(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Fe(t,e,n){if("function"==typeof t)n&&(t=ft(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ft(t.handleEvent,t)}return 2147483647<Number(e)?-1:it.setTimeout(t,e||0)}function Ve(t){t.a=Fe((function(){t.a=null,t.c&&(t.c=!1,Ve(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}yt(Pe,Ie),(et=Pe.prototype).aa=!1,et.M=null,et.Za=function(){if(this.aa){var t=dt()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),_e(this,"tick"),this.aa&&(Me(this),this.start()))}},et.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=dt())},et.G=function(){Pe.X.G.call(this),Me(this),delete this.a};var Ue=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Ve(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(it.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(vt);function qe(t){vt.call(this),this.b=t,this.a={}}yt(qe,vt);var Be=[];function je(t,e,n,r){Array.isArray(n)||(n&&(Be[0]=n.toString()),n=Be);for(var i=0;i<n.length;i++){var o=he(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ke(t){Dt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&de(t)}),t),t.a={}}function Ge(){this.a=!0}function ze(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Te(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}qe.prototype.G=function(){qe.X.G.call(this),Ke(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ge.prototype.info=function(){};var He={},Qe=null;function We(){return Qe=Qe||new Ie}function Ye(t){Jt.call(this,He.Fa,t)}function $e(t){var e=We();_e(e,new Ye(e,t))}function Xe(t,e){Jt.call(this,He.STAT_EVENT,t),this.stat=e}function Je(t){var e=We();_e(e,new Xe(e,t))}function Ze(t){Jt.call(this,He.Ga,t)}function tn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return it.setTimeout((function(){t()}),e)}He.Fa="serverreachability",yt(Ye,Jt),He.STAT_EVENT="statevent",yt(Xe,Jt),He.Ga="timingevent",yt(Ze,Jt);var en={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},nn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function rn(){}function on(t){var e;return(e=t.a)||(e=t.a={}),e}function sn(){}rn.prototype.a=null;var an,un={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function cn(){Jt.call(this,"d")}function hn(){Jt.call(this,"c")}function ln(){}function fn(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new qe(this),this.P=pn,t=Vt?125:void 0,this.R=new Pe(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}yt(cn,Jt),yt(hn,Jt),yt(ln,rn),an=new ln;var pn=45e3,dn={},yn={};function vn(t,e,n){t.H=1,t.i=Vn(xn(e)),t.j=n,t.I=!0,mn(t,null)}function mn(t,e){t.u=dt(),wn(t),t.l=xn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Xn(n.b,"t",r),t.D=0,t.a=zr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ue(ft(t.Ca,t,t.a),t.O)),je(t.J,t.a,"readystatechange",t.Xa),e=t.B?Ct(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),$e(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function gn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=bn(t,n);if(i==yn){4==e&&(t.h=4,Je(14),r=!1),ze(t.c,t.f,null,"[Incomplete Response]");break}if(i==dn){t.h=4,Je(15),ze(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}ze(t.c,t.f,i,null),Sn(t,i)}4==e&&0==n.length&&(t.h=1,Je(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Fr(e),e.F=!0,Je(11))):(ze(t.c,t.f,n,"[Invalid Chunked Response]"),Tn(t),En(t))}function bn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?yn:(n=Number(e.substring(n,r)),isNaN(n)?dn:(r+=1)+n>e.length?yn:(e=e.substr(r,n),t.D=r+n,e))}function wn(t){t.T=dt()+t.P,In(t,t.P)}function In(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=tn(ft(t.Va,t),e)}function _n(t){t.o&&(it.clearTimeout(t.o),t.o=null)}function En(t){0==t.g.v||t.A||qr(t.g,t)}function Tn(t){_n(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Me(t.R),Ke(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Sn(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||ir(n.b,t)))if(n.I=t.N,!t.C&&ir(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Ur(n),Dr(n)}Mr(n),Je(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=tn(ft(n.Sa,n),6e3));if(1>=rr(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else jr(n,11)}else if((t.C||n.a==t)&&Ur(n),!It(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(Tt(h,"spdy")||Tt(h,"quic")||Tt(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(or(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Fn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=dt()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=Gr(u,u.C?u.ga:null,u.fa),p.C){sr(u.b,p);var d=p,y=u.D;y&&d.setTimeout(y),d.o&&(_n(d),wn(d)),u.a=p}else Pr(u);0<n.g.length&&Rr(n)}else"stop"!=i[0]&&"close"!=i[0]||jr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?jr(n,7):Nr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);$e(4)}catch(t){}}function An(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(st(t)||"string"==typeof t)gt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(st(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(st(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Nn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Nn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Dn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Cn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Cn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(et=fn.prototype).setTimeout=function(t){this.P=t},et.Xa=function(t){t=t.target;var e=this.F;e&&3==Er(t)?e.f():this.Ca(t)},et.Ca=function(t){try{if(t==this.a)t:{var e=Er(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Vt&&!this.a.$())){this.A||4!=e||7==n||$e(8==n||0>=r?3:2),_n(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!It(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Je(12),Tn(this),En(this);break t}ze(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Sn(this,u)}this.I?(gn(this,e,o),Vt&&this.b&&3==e&&(je(this.J,this.R,"tick",this.Wa),this.R.start())):(ze(this.c,this.f,o,null),Sn(this,o)),4==e&&Tn(this),this.b&&!this.A&&(4==e?qr(this.g,this):(this.b=!1,wn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Je(12)):(this.h=0,Je(13)),Tn(this),En(this)}}}catch(t){}},et.Wa=function(){if(this.a){var t=Er(this.a),e=this.a.$();this.D<e.length&&(_n(this),gn(this,t,e),this.b&&4!=t&&wn(this))}},et.cancel=function(){this.A=!0,Tn(this)},et.Va=function(){this.o=null;var t=dt();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&($e(3),Je(17)),Tn(this),this.h=2,En(this)):In(this,this.T-t)},(et=Nn.prototype).K=function(){Dn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},et.L=function(){return Dn(this),this.a.concat()},et.get=function(t,e){return Cn(this.b,t)?this.b[t]:e},et.set=function(t,e){Cn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},et.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var kn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Rn){this.a=void 0!==e?e:t.a,On(this,t.f),this.j=t.j,Ln(this,t.c),Pn(this,t.h),this.g=t.g,e=t.b;var n=new Qn;n.c=e.c,e.a&&(n.a=new Nn(e.a),n.b=e.b),Mn(this,n),this.i=t.i}else t&&(n=String(t).match(kn))?(this.a=!!e,On(this,n[1]||"",!0),this.j=Un(n[2]||""),Ln(this,n[3]||"",!0),Pn(this,n[4]),this.g=Un(n[5]||"",!0),Mn(this,n[6]||"",!0),this.i=Un(n[7]||"")):(this.a=!!e,this.b=new Qn(null,this.a))}function xn(t){return new Rn(t)}function On(t,e,n){t.f=n?Un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ln(t,e,n){t.c=n?Un(e,!0):e}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Mn(t,e,n){e instanceof Qn?(t.b=e,function(t,e){e&&!t.f&&(Wn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Yn(this,e),Xn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=qn(e,zn)),t.b=new Qn(e,t.a))}function Fn(t,e,n){t.b.set(e,n)}function Vn(t){return Fn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^dt()).toString(36)),t}function Un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Bn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Bn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(qn(e,jn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(qn(e,jn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(qn(n,"/"==n.charAt(0)?Gn:Kn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",qn(n,Hn)),t.join("")};var jn=/[#\/\?@]/g,Kn=/[#\?:]/g,Gn=/[#\?]/g,zn=/[#\?@]/g,Hn=/#/g;function Qn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Wn(t){t.a||(t.a=new Nn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Yn(t,e){Wn(t),e=Jn(t,e),Cn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Cn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Dn(t)))}function $n(t,e){return Wn(t),e=Jn(t,e),Cn(t.a.b,e)}function Xn(t,e,n){Yn(t,e),0<n.length&&(t.c=null,t.a.set(Jn(t,e),wt(n)),t.b+=n.length)}function Jn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(et=Qn.prototype).add=function(t,e){Wn(this),this.c=null,t=Jn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},et.forEach=function(t,e){Wn(this),this.a.forEach((function(n,r){gt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},et.L=function(){Wn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},et.K=function(t){Wn(this);var e=[];if("string"==typeof t)$n(this,t)&&(e=bt(e,this.a.get(Jn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=bt(e,t[n])}return e},et.set=function(t,e){return Wn(this),this.c=null,$n(this,t=Jn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},et.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},et.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Zn=function(t,e){this.b=t,this.a=e};function tr(t){this.g=t||er,t=it.PerformanceNavigationTiming?0<(t=it.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(it.ia&&it.ia.ya&&it.ia.ya()&&it.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var er=10;function nr(t){return!!t.b||!!t.a&&t.a.size>=t.f}function rr(t){return t.b?1:t.a?t.a.size:0}function ir(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function or(t,e){t.a?t.a.add(e):t.b=e}function sr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function ar(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=tt(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return wt(t.c)}function ur(){}function cr(){this.a=new ur}function hr(t,e,n){var r=n||"";try{An(t,(function(t,n){var i=t;at(t)&&(i=Te(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function lr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}tr.prototype.cancel=function(){var t,e;if(this.c=ar(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=tt(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ur.prototype.stringify=function(t){return it.JSON.stringify(t,void 0)},ur.prototype.parse=function(t){return it.JSON.parse(t,void 0)};var fr=it.JSON.parse;function pr(t){Ie.call(this),this.headers=new Nn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=dr,this.D=this.F=!1}yt(pr,Ie);var dr="",yr=/^https?$/i,vr=["POST","PUT"];function mr(t){return"content-type"==t.toLowerCase()}function gr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,br(t),Ir(t)}function br(t){t.u||(t.u=!0,_e(t,"complete"),_e(t,"error"))}function wr(t){if(t.b&&void 0!==rt&&(!t.s[1]||4!=Er(t)||2!=t.W()))if(t.l&&4==Er(t))Fe(t.za,0,t);else if(_e(t,"readystatechange"),4==Er(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(kn)[1]||null;if(!o&&it.self&&it.self.location){var s=it.self.location.protocol;o=s.substr(0,s.length-1)}i=!yr.test(o?o.toLowerCase():"")}e=i}if(e)_e(t,"complete"),_e(t,"success");else{t.h=6;try{var a=2<Er(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",br(t)}}finally{Ir(t)}}}function Ir(t,e){if(t.a){_r(t);var n=t.a,r=t.s[0]?ot:null;t.a=null,t.s=null,e||_e(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function _r(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(it.clearTimeout(t.m),t.m=null)}function Er(t){return t.a?t.a.readyState:0}function Tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Dt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Fn(t,e,n))}function Sr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ar(t){this.pa=0,this.g=[],this.c=new Ge,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Sr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Sr("baseRetryDelayMs",5e3,t),this.Ra=Sr("retryDelaySeedMs",1e4,t),this.Ma=Sr("forwardChannelMaxRetries",2,t),this.ma=Sr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new tr(t&&t.concurrentRequestLimit),this.ka=new cr,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Nr(t){if(Cr(t),3==t.v){var e=t.R++,n=xn(t.B);Fn(n,"SID",t.J),Fn(n,"RID",e),Fn(n,"TYPE","terminate"),Or(t,n),(e=new fn(t,t.c,e,void 0)).H=2,e.i=Vn(xn(n)),n=!1,it.navigator&&it.navigator.sendBeacon&&(n=it.navigator.sendBeacon(e.i.toString(),"")),!n&&it.Image&&((new Image).src=e.i,n=!0),n||(e.a=zr(e.g,null),e.a.ba(e.i)),e.u=dt(),wn(e)}Kr(t)}function Dr(t){t.a&&(Fr(t),t.a.cancel(),t.a=null)}function Cr(t){Dr(t),t.j&&(it.clearTimeout(t.j),t.j=null),Ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&it.clearTimeout(t.h),t.h=null)}function kr(t,e){t.g.push(new Zn(t.Oa++,e)),3==t.v&&Rr(t)}function Rr(t){nr(t.b)||t.h||(t.h=!0,Re(t.Ba,t),t.u=0)}function xr(t,e){var n;n=e?e.f:t.R++;var r=xn(t.B);Fn(r,"SID",t.J),Fn(r,"RID",n),Fn(r,"AID",t.P),Or(t,r),t.i&&t.l&&Tr(r,t.i,t.l),n=new fn(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Lr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),or(t.b,n),vn(n,r,e)}function Or(t,e){t.f&&An({},(function(t,n){Fn(e,n,t)}))}function Lr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ft(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{hr(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Pr(t){t.a||t.j||(t.T=1,Re(t.Aa,t),t.o=0)}function Mr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=tn(ft(t.Aa,t),Br(t,t.o)),t.o++,0))}function Fr(t){null!=t.s&&(it.clearTimeout(t.s),t.s=null)}function Vr(t){t.a=new fn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=xn(t.la);Fn(e,"RID","rpc"),Fn(e,"SID",t.J),Fn(e,"CI",t.H?"0":"1"),Fn(e,"AID",t.P),Or(t,e),Fn(e,"TYPE","xmlhttp"),t.i&&t.l&&Tr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Vn(xn(e)),n.j=null,n.I=!0,mn(n,t)}function Ur(t){null!=t.m&&(it.clearTimeout(t.m),t.m=null)}function qr(t,e){var n=null;if(t.a==e){Ur(t),Fr(t),t.a=null;var r=2}else{if(!ir(t.b,e))return;n=e.s,sr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=dt()-e.u;var i=t.u;_e(r=We(),new Ze(r,n,e,i)),Rr(t)}else Pr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(rr(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=tn(ft(t.Ba,t,e),Br(t,t.u)),t.u++,0)))}(t,e)||2==r&&Mr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:jr(t,5);break;case 4:jr(t,10);break;case 3:jr(t,6);break;default:jr(t,2)}}function Br(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function jr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ft(t.Ya,t);n||(n=new Rn("//www.google.com/images/cleardot.gif"),it.location&&"http"==it.location.protocol||On(n,"https"),Vn(n)),function(t,e){var n=new Ge;if(it.Image){var r=new Image;r.onload=pt(lr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=pt(lr,n,r,"TestLoadImage: error",!1,e),r.onabort=pt(lr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=pt(lr,n,r,"TestLoadImage: timeout",!1,e),it.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Je(2);t.v=0,t.f&&t.f.ra(e),Kr(t),Cr(t)}function Kr(t){t.v=0,t.I=-1,t.f&&(0==ar(t.b).length&&0==t.g.length||(t.b.c.length=0,wt(t.g),t.g.length=0),t.f.qa())}function Gr(t,e,n){var r=function(t){return t instanceof Rn?xn(t):new Rn(t,void 0)}(n);if(""!=r.c)e&&Ln(r,e+"."+r.c),Pn(r,r.h);else{var i=it.location;r=function(t,e,n,r){var i=new Rn(null,void 0);return t&&On(i,t),e&&Ln(i,e),n&&Pn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&Dt(t.V,(function(t,e){Fn(r,e,t)})),e=t.A,n=t.na,e&&n&&Fn(r,e,n),Fn(r,"VER",t.ha),Or(t,r),r}function zr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new pr(t.Na)).F=t.C,e}function Hr(){}function Qr(){if(Mt&&!(10<=Number(Wt)))throw Error("Environmental error: no available transport.")}function Wr(t,e){Ie.call(this),this.a=new Ar(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!It(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!It(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Xr(this)}function Yr(t){cn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function $r(){hn.call(this),this.status=1}function Xr(t){this.a=t}(et=pr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?on(this.H):on(an),this.a.onreadystatechange=ft(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void gr(this,t)}t=n||"";var i=new Nn(this.headers);r&&An(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=mr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=it.FormData&&t instanceof it.FormData,!(0<=mt(vr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{_r(this),0<this.o&&((this.D=function(t){return Mt&&Qt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ft(this.xa,this)):this.m=Fe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){gr(this,t)}},et.xa=function(){void 0!==rt&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,_e(this,"timeout"),this.abort(8))},et.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,_e(this,"complete"),_e(this,"abort"),Ir(this))},et.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ir(this,!0)),pr.X.G.call(this)},et.za=function(){this.j||(this.A||this.l||this.g?wr(this):this.Ua())},et.Ua=function(){wr(this)},et.W=function(){try{return 2<Er(this)?this.a.status:-1}catch(t){return-1}},et.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},et.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),fr(e)}},et.ua=function(){return this.h},et.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(et=Ar.prototype).ha=8,et.v=1,et.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new fn(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Rt(r=Ct(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Lr(this,n,e),Fn(i=xn(this.B),"RID",t),Fn(i,"CVER",22),this.A&&Fn(i,"X-HTTP-Session-Id",this.A),Or(this,i),this.i&&r&&Tr(i,this.i,r),or(this.b,n),this.Ia&&Fn(i,"TYPE","init"),this.da?(Fn(i,"$req",e),Fn(i,"SID","null"),n.U=!0,vn(n,i,null)):vn(n,i,e),this.v=2}}else 3==this.v&&(t?xr(this,t):0==this.g.length||nr(this.b)||xr(this))},et.Aa=function(){if(this.j=null,Vr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=tn(ft(this.Ta,this),t)}},et.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Je(10),Dr(this),Vr(this))},et.Sa=function(){null!=this.m&&(this.m=null,Dr(this),Mr(this),Je(19))},et.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Je(2)):(this.c.info("Failed to ping google.com"),Je(1))},(et=Hr.prototype).ta=function(){},et.sa=function(){},et.ra=function(){},et.qa=function(){},et.Ja=function(){},Qr.prototype.a=function(t,e){return new Wr(t,e)},yt(Wr,Ie),Wr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Je(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Gr(t,null,t.fa),Rr(t)},Wr.prototype.close=function(){Nr(this.a)},Wr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,kr(this.a,e)}else this.l?((e={}).__data__=Te(t),kr(this.a,e)):kr(this.a,t)},Wr.prototype.G=function(){this.a.f=null,delete this.f,Nr(this.a),delete this.a,Wr.X.G.call(this)},yt(Yr,cn),yt($r,hn),yt(Xr,Hr),Xr.prototype.ta=function(){_e(this.a,"a")},Xr.prototype.sa=function(t){_e(this.a,new Yr(t))},Xr.prototype.ra=function(t){_e(this.a,new $r(t))},Xr.prototype.qa=function(){_e(this.a,"b")},Qr.prototype.createWebChannel=Qr.prototype.a,Wr.prototype.send=Wr.prototype.h,Wr.prototype.open=Wr.prototype.g,Wr.prototype.close=Wr.prototype.close,en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,nn.COMPLETE="complete",sn.EventType=un,un.OPEN="a",un.CLOSE="b",un.ERROR="c",un.MESSAGE="d",Ie.prototype.listen=Ie.prototype.va,pr.prototype.listenOnce=pr.prototype.wa,pr.prototype.getLastError=pr.prototype.Qa,pr.prototype.getLastErrorCode=pr.prototype.ua,pr.prototype.getStatus=pr.prototype.W,pr.prototype.getResponseJson=pr.prototype.Pa,pr.prototype.getResponseText=pr.prototype.$,pr.prototype.send=pr.prototype.ba;var Jr=en,Zr=nn,ti=He,ei=10,ni=11,ri=sn,ii=pr,oi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();oi.o=-1;var si={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ai=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return n(e,t),e}(Error),ui=new M("@firebase/firestore");function ci(){return ui.logLevel}function hi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ui.logLevel<=C.DEBUG){var r=e.map(pi);ui.debug.apply(ui,u(["Firestore (8.6.3): "+t],r))}}function li(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ui.logLevel<=C.ERROR){var r=e.map(pi);ui.error.apply(ui,u(["Firestore (8.6.3): "+t],r))}}function fi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ui.logLevel<=C.WARN){var r=e.map(pi);ui.warn.apply(ui,u(["Firestore (8.6.3): "+t],r))}}function pi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function di(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.3) INTERNAL ASSERTION FAILED: "+t;throw li(e),new Error(e)}function yi(t,e){t||di()}function vi(t,e){return t}function mi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var gi=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=mi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function bi(t,e){return t<e?-1:t>e?1:0}function wi(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ii(t){return t+"\0"}var _i=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ai(si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ai(si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ai(si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ai(si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?bi(this.nanoseconds,t.nanoseconds):bi(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Ei=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new _i(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Ti(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Si(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ai(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ni=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&di(),void 0===n?n=t.length-e:n>t.length-e&&di(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ai(si.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Ni),Ci=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Ci.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ai(si.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new ai(si.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ai(si.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new ai(si.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Ni),Ri=function(){function t(t){this.fields=t,t.sort(ki.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return wi(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),xi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return bi(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();xi.EMPTY_BYTE_STRING=new xi("");var Oi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Li(t){if(yi(!!t),"string"==typeof t){var e=0,n=Oi.exec(t);if(yi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pi(t.seconds),nanos:Pi(t.nanos)}}function Pi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mi(t){return"string"==typeof t?xi.fromBase64String(t):xi.fromUint8Array(t)}function Fi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Vi(t){var e=t.mapValue.fields.__previous_value__;return Fi(e)?Vi(e):e}function Ui(t){var e=Li(t.mapValue.fields.__local_write_time__.timestampValue);return new _i(e.seconds,e.nanos)}function qi(t){return null==t}function Bi(t){return 0===t&&1/t==-1/0}function ji(t){return"number"==typeof t&&Number.isInteger(t)&&!Bi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ki=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Di.fromString(e))},t.fromName=function(e){return new t(Di.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Di.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Di.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Di(e.slice()))},t}();function Gi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fi(t)?4:10:di()}function zi(t,e){var n=Gi(t);if(n!==Gi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ui(t).isEqual(Ui(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Li(t.timestampValue),r=Li(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Mi(t.bytesValue).isEqual(Mi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Pi(t.geoPointValue.latitude)===Pi(e.geoPointValue.latitude)&&Pi(t.geoPointValue.longitude)===Pi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Pi(t.integerValue)===Pi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Pi(t.doubleValue),r=Pi(e.doubleValue);return n===r?Bi(n)===Bi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return wi(t.arrayValue.values||[],e.arrayValue.values||[],zi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ti(n)!==Ti(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!zi(n[i],r[i])))return!1;return!0}(t,e);default:return di()}}function Hi(t,e){return void 0!==(t.values||[]).find((function(t){return zi(t,e)}))}function Qi(t,e){var n=Gi(t),r=Gi(e);if(n!==r)return bi(n,r);switch(n){case 0:return 0;case 1:return bi(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Pi(t.integerValue||t.doubleValue),r=Pi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Wi(t.timestampValue,e.timestampValue);case 4:return Wi(Ui(t),Ui(e));case 5:return bi(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Mi(t),r=Mi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=bi(n[i],r[i]);if(0!==o)return o}return bi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=bi(Pi(t.latitude),Pi(e.latitude));return 0!==n?n:bi(Pi(t.longitude),Pi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qi(n[i],r[i]);if(o)return o}return bi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=bi(r[s],o[s]);if(0!==a)return a;var u=Qi(n[r[s]],i[o[s]]);if(0!==u)return u}return bi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw di()}}function Wi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return bi(t,e);var n=Li(t),r=Li(e),i=bi(n.seconds,r.seconds);return 0!==i?i:bi(n.nanos,r.nanos)}function Yi(t){return $i(t)}function $i(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Li(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Mi(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ki.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=$i(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+$i(t.fields[o])}return e+"}"}(t.mapValue):di();var e,n}function Xi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ji(t){return!!t&&"integerValue"in t}function Zi(t){return!!t&&"arrayValue"in t}function to(t){return!!t&&"nullValue"in t}function eo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function no(t){return!!t&&"mapValue"in t}function ro(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},Li(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return Si(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=ro(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=ro(t.arrayValue.values[r]);return n}return Object.assign({},t)}var io=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!no(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ro(e)},t.prototype.setAll=function(t){var e=this,n=ki.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=ro(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());no(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return zi(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];no(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Si(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(ro(this.value))},t}();function oo(t){var e=[];return Si(t.fields,(function(t,n){var r=new ki([t]);if(no(n)){var i=oo(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Ri(e)}var so=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Ei.min(),io.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,io.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,io.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=io.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=io.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),ao=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function uo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ao(t,e,n,r,i,o,s)}function co(t){var e=vi(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Yi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),qi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Eo(e.startAt)),e.endAt&&(n+="|ub:",n+=Eo(e.endAt)),e.h=n}return e.h}function ho(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!So(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!zi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!No(t.startAt,e.startAt)&&No(t.endAt,e.endAt)}function lo(t){return Ki.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var fo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return n(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new po(t,n,r):"array-contains"===n?new go(t,r):"in"===n?new bo(t,r):"not-in"===n?new wo(t,r):"array-contains-any"===n?new Io(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new yo(t,n):new vo(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Qi(e,this.value)):null!==e&&Gi(this.value)===Gi(e)&&this.m(Qi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return di()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),po=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ki.fromName(r.referenceValue),i}return n(e,t),e.prototype.matches=function(t){var e=Ki.comparator(t.key,this.key);return this.m(e)},e}(fo),yo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=mo(0,n),r}return n(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(fo),vo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=mo(0,n),r}return n(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(fo);function mo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ki.fromName(t.referenceValue)}))}var go=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return n(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Zi(e)&&Hi(e.arrayValue,this.value)},e}(fo),bo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return n(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Hi(this.value.arrayValue,e)},e}(fo),wo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return n(e,t),e.prototype.matches=function(t){if(Hi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Hi(this.value.arrayValue,e)},e}(fo),Io=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return n(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Zi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Hi(e.value.arrayValue,t)}))},e}(fo),_o=function(t,e){this.position=t,this.before=e};function Eo(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Yi(t)})).join(",")}var To=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function So(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ao(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ki.comparator(Ki.fromName(s.referenceValue),n.key):Qi(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function No(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zi(t.position[n],e.position[n]))return!1;return!0}var Do=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Co(t,e,n,r,i,o,s,a){return new Do(t,e,n,r,i,o,s,a)}function ko(t){return new Do(t)}function Ro(t){return!qi(t.limit)&&"F"===t.limitType}function xo(t){return!qi(t.limit)&&"L"===t.limitType}function Oo(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Lo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Po(t){return null!==t.collectionGroup}function Mo(t){var e=vi(t);if(null===e.p){e.p=[];var n=Lo(e),r=Oo(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new To(n)),e.p.push(new To(ki.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new To(ki.keyField(),u))}}}return e.p}function Fo(t){var e=vi(t);if(!e.T)if("F"===e.limitType)e.T=uo(e.path,e.collectionGroup,Mo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Mo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new To(o.field,s))}var a=e.endAt?new _o(e.endAt.position,!e.endAt.before):null,u=e.startAt?new _o(e.startAt.position,!e.startAt.before):null;e.T=uo(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Vo(t,e,n){return new Do(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uo(t,e){return ho(Fo(t),Fo(e))&&t.limitType===e.limitType}function qo(t){return co(Fo(t))+"|lt:"+t.limitType}function Bo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Yi(e.value);var e})).join(", ")+"]"),qi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Eo(t.startAt)),t.endAt&&(e+=", endAt: "+Eo(t.endAt)),"Target("+e+")"}(Fo(t))+"; limitType="+t.limitType+")"}function jo(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ki.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ao(t.startAt,Mo(t),e)||t.endAt&&Ao(t.endAt,Mo(t),e))}(t,e)}function Ko(t){return function(e,n){for(var r=!1,i=0,o=Mo(t);i<o.length;i++){var s=o[i],a=Go(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Go(t,e,n){var r=t.field.isKeyField()?Ki.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Qi(r,i):di()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return di()}}function zo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bi(e)?"-0":e}}function Ho(t){return{integerValue:""+t}}function Qo(t,e){return ji(e)?Ho(e):zo(t,e)}var Wo=function(){this._=void 0};function Yo(t,e,n){return t instanceof Jo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Zo?ts(t,e):t instanceof es?ns(t,e):function(t,e){var n=Xo(t,e),r=is(n)+is(t.A);return Ji(n)&&Ji(t.A)?Ho(r):zo(t.R,r)}(t,e)}function $o(t,e,n){return t instanceof Zo?ts(t,e):t instanceof es?ns(t,e):n}function Xo(t,e){return t instanceof rs?Ji(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(Wo),Zo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return n(e,t),e}(Wo);function ts(t,e){for(var n=os(e),r=function(t){n.some((function(e){return zi(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var es=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return n(e,t),e}(Wo);function ns(t,e){for(var n=os(e),r=function(t){n=n.filter((function(e){return!zi(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return n(e,t),e}(Wo);function is(t){return Pi(t.integerValue||t.doubleValue)}function os(t){return Zi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ss=function(t,e){this.field=t,this.transform=e},as=function(t,e){this.version=t,this.transformResults=e},us=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function cs(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var hs=function(){};function ls(t,e,n){t instanceof vs?function(t,e,n){var r=t.value.clone(),i=bs(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof ms?function(t,e,n){if(cs(t.precondition,e)){var r=bs(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(gs(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function fs(t,e,n){t instanceof vs?function(t,e,n){if(cs(t.precondition,e)){var r=t.value.clone(),i=ws(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(ys(e),r).setHasLocalMutations()}}(t,e,n):t instanceof ms?function(t,e,n){if(cs(t.precondition,e)){var r=ws(t.fieldTransforms,n,e),i=e.data;i.setAll(gs(t)),i.setAll(r),e.convertToFoundDocument(ys(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){cs(t.precondition,e)&&e.convertToNoDocument(Ei.min())}(t,e)}function ps(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Xo(o.transform,s||null);null!=a&&(null==n&&(n=io.empty()),n.set(o.field,a))}return n||null}function ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&wi(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Zo&&e instanceof Zo||t instanceof es&&e instanceof es?wi(t.elements,e.elements,zi):t instanceof rs&&e instanceof rs?zi(t.A,e.A):t instanceof Jo&&e instanceof Jo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function ys(t){return t.isFoundDocument()?t.version:Ei.min()}var vs=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return n(e,t),e}(hs),ms=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return n(e,t),e}(hs);function gs(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function bs(t,e,n){var r=new Map;yi(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,$o(s,a,n[i]))}return r}function ws(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Yo(a,u,e))}return r}var Is,_s,Es=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return n(e,t),e}(hs),Ts=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return n(e,t),e}(hs),Ss=function(t){this.count=t};function As(t){switch(t){case si.OK:return di();case si.CANCELLED:case si.UNKNOWN:case si.DEADLINE_EXCEEDED:case si.RESOURCE_EXHAUSTED:case si.INTERNAL:case si.UNAVAILABLE:case si.UNAUTHENTICATED:return!1;case si.INVALID_ARGUMENT:case si.NOT_FOUND:case si.ALREADY_EXISTS:case si.PERMISSION_DENIED:case si.FAILED_PRECONDITION:case si.ABORTED:case si.OUT_OF_RANGE:case si.UNIMPLEMENTED:case si.DATA_LOSS:return!0;default:return di()}}function Ns(t){if(void 0===t)return li("GRPC error has no .code"),si.UNKNOWN;switch(t){case Is.OK:return si.OK;case Is.CANCELLED:return si.CANCELLED;case Is.UNKNOWN:return si.UNKNOWN;case Is.DEADLINE_EXCEEDED:return si.DEADLINE_EXCEEDED;case Is.RESOURCE_EXHAUSTED:return si.RESOURCE_EXHAUSTED;case Is.INTERNAL:return si.INTERNAL;case Is.UNAVAILABLE:return si.UNAVAILABLE;case Is.UNAUTHENTICATED:return si.UNAUTHENTICATED;case Is.INVALID_ARGUMENT:return si.INVALID_ARGUMENT;case Is.NOT_FOUND:return si.NOT_FOUND;case Is.ALREADY_EXISTS:return si.ALREADY_EXISTS;case Is.PERMISSION_DENIED:return si.PERMISSION_DENIED;case Is.FAILED_PRECONDITION:return si.FAILED_PRECONDITION;case Is.ABORTED:return si.ABORTED;case Is.OUT_OF_RANGE:return si.OUT_OF_RANGE;case Is.UNIMPLEMENTED:return si.UNIMPLEMENTED;case Is.DATA_LOSS:return si.DATA_LOSS;default:return di()}}(_s=Is||(Is={}))[_s.OK=0]="OK",_s[_s.CANCELLED=1]="CANCELLED",_s[_s.UNKNOWN=2]="UNKNOWN",_s[_s.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_s[_s.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_s[_s.NOT_FOUND=5]="NOT_FOUND",_s[_s.ALREADY_EXISTS=6]="ALREADY_EXISTS",_s[_s.PERMISSION_DENIED=7]="PERMISSION_DENIED",_s[_s.UNAUTHENTICATED=16]="UNAUTHENTICATED",_s[_s.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_s[_s.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_s[_s.ABORTED=10]="ABORTED",_s[_s.OUT_OF_RANGE=11]="OUT_OF_RANGE",_s[_s.UNIMPLEMENTED=12]="UNIMPLEMENTED",_s[_s.INTERNAL=13]="INTERNAL",_s[_s.UNAVAILABLE=14]="UNAVAILABLE",_s[_s.DATA_LOSS=15]="DATA_LOSS";var Ds=function(){function t(t,e){this.comparator=t,this.root=e||ks.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ks.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ks.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Cs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Cs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Cs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Cs(this.root,t,this.comparator,!0)},t}(),Cs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),ks=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw di();if(this.right.isRed())throw di();var t=this.left.check();if(t!==this.right.check())throw di();return t+(this.isRed()?0:1)},t}();ks.EMPTY=null,ks.RED=!0,ks.BLACK=!1,ks.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw di()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw di()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw di()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw di()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw di()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new ks(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Rs=function(){function t(t){this.comparator=t,this.data=new Ds(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new xs(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new xs(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),xs=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Os=new Ds(Ki.comparator);function Ls(){return Os}var Ps=new Ds(Ki.comparator);function Ms(){return Ps}var Fs=new Ds(Ki.comparator);function Vs(){return Fs}var Us=new Rs(Ki.comparator);function qs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Us,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Bs=new Rs(bi);function js(){return Bs}var Ks=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Gs.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Ei.min(),r,js(),Ls(),qs())},t}(),Gs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(xi.EMPTY_BYTE_STRING,n,qs(),qs(),qs())},t}(),zs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Hs=function(t,e){this.targetId=t,this.V=e},Qs=function(t,e,n,r){void 0===n&&(n=xi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ws=function(){function t(){this.S=0,this.D=Xs(),this.C=xi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=qs(),e=qs(),n=qs();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:di()}})),new Gs(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Xs()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Ys=function(){function t(t){this.W=t,this.G=new Map,this.H=Ls(),this.J=$s(),this.Y=new Rs(bi)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:di()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(lo(i))if(0===n){var o=new Ki(i.path);this.tt(e,o,so.newNoDocument(o,Ei.min()))}else yi(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&lo(o.target)){var s=new Ki(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,so.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=qs();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ks(t,n,this.Y,this.H,r);return this.H=Ls(),this.J=$s(),this.Y=new Rs(bi),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ws,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Rs(bi),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||hi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ws),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function $s(){return new Ds(Ki.comparator)}function Xs(){return new Ds(Ki.comparator)}var Js={asc:"ASCENDING",desc:"DESCENDING"},Zs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ta=function(t,e){this.databaseId=t,this.I=e};function ea(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function na(t,e){return t.I?e.toBase64():e.toUint8Array()}function ra(t,e){return ea(t,e.toTimestamp())}function ia(t){return yi(!!t),Ei.fromTimestamp(function(t){var e=Li(t);return new _i(e.seconds,e.nanos)}(t))}function oa(t,e){return function(t){return new Di(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function sa(t){var e=Di.fromString(t);return yi(ka(e)),e}function aa(t,e){return oa(t.databaseId,e.path)}function ua(t,e){var n=sa(e);if(n.get(1)!==t.databaseId.projectId)throw new ai(si.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ai(si.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ki(fa(n))}function ca(t,e){return oa(t.databaseId,e)}function ha(t){var e=sa(t);return 4===e.length?Di.emptyPath():fa(e)}function la(t){return new Di(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fa(t){return yi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function pa(t,e,n){return{name:aa(t,e),fields:n.value.mapValue.fields}}function da(t,e,n){var r=ua(t,e.name),i=ia(e.updateTime),o=new io({mapValue:{fields:e.fields}}),s=so.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function ya(t,e){var n;if(e instanceof vs)n={update:pa(t,e.key,e.value)};else if(e instanceof Es)n={delete:aa(t,e.key)};else if(e instanceof ms)n={update:pa(t,e.key,e.data),updateMask:Ca(e.fieldMask)};else{if(!(e instanceof Ts))return di();n={verify:aa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Jo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Zo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof es)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof rs)return{fieldPath:e.field.canonicalString(),increment:n.A};throw di()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ra(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:di()}(t,e.precondition)),n}function va(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?us.updateTime(ia(t.updateTime)):void 0!==t.exists?us.exists(t.exists):us.none()}(e.currentDocument):us.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)yi("REQUEST_TIME"===e.setToServerValue),n=new Jo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Zo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new es(i)}else"increment"in e?n=new rs(t,e.increment):di();var o=ki.fromServerFormat(e.fieldPath);return new ss(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=ua(t,e.update.name),o=new io({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Ri(e.map((function(t){return ki.fromServerFormat(t)})))}(e.updateMask);return new ms(i,o,s,n,r)}return new vs(i,o,n,r)}if(e.delete){var a=ua(t,e.delete);return new Es(a,n)}if(e.verify){var u=ua(t,e.verify);return new Ts(u,n)}return di()}function ma(t,e){return{documents:[ca(t,e.path)]}}function ga(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ca(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ca(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(eo(t.value))return{unaryFilter:{field:Sa(t.field),op:"IS_NAN"}};if(to(t.value))return{unaryFilter:{field:Sa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(eo(t.value))return{unaryFilter:{field:Sa(t.field),op:"IS_NOT_NAN"}};if(to(t.value))return{unaryFilter:{field:Sa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sa(t.field),op:Ta(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Sa(t.field),direction:Ea(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||qi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ia(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ia(e.endAt)),n}function ba(t){var e=ha(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){yi(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=wa(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new To(Aa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return qi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=_a(n.startAt));var h=null;return n.endAt&&(h=_a(n.endAt)),Co(e,i,a,s,u,"F",c,h)}function wa(t){return t?void 0!==t.unaryFilter?[Da(t)]:void 0!==t.fieldFilter?[Na(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return wa(t)})).reduce((function(t,e){return t.concat(e)})):di():[]}function Ia(t){return{before:t.before,values:t.position}}function _a(t){var e=!!t.before,n=t.values||[];return new _o(n,e)}function Ea(t){return Js[t]}function Ta(t){return Zs[t]}function Sa(t){return{fieldPath:t.canonicalString()}}function Aa(t){return ki.fromServerFormat(t.fieldPath)}function Na(t){return fo.create(Aa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return di()}}(t.fieldFilter.op),t.fieldFilter.value)}function Da(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Aa(t.unaryFilter.field);return fo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Aa(t.unaryFilter.field);return fo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Aa(t.unaryFilter.field);return fo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Aa(t.unaryFilter.field);return fo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return di()}}function Ca(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function ka(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ra(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Oa(e)),e=xa(t.get(n),e);return Oa(e)}function xa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Oa(t){return t+""}function La(t){var e=t.length;if(yi(e>=2),2===e)return yi(""===t.charAt(0)&&""===t.charAt(1)),Di.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&di(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:di()}o=s+2}return new Di(r)}var Pa=function(t,e){this.seconds=t,this.nanoseconds=e},Ma=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ma.store="owner",Ma.key="owner";var Fa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fa.store="mutationQueues",Fa.keyPath="userId";var Va=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Va.store="mutations",Va.keyPath="batchId",Va.userMutationsIndex="userMutationsIndex",Va.userMutationsKeyPath=["userId","batchId"];var Ua=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ra(e)]},t.key=function(t,e,n){return[t,Ra(e),n]},t}();Ua.store="documentMutations",Ua.PLACEHOLDER=new Ua;var qa=function(t,e){this.path=t,this.readTime=e},Ba=function(t,e){this.path=t,this.version=e},ja=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ja.store="remoteDocuments",ja.readTimeIndex="readTimeIndex",ja.readTimeIndexPath="readTime",ja.collectionReadTimeIndex="collectionReadTimeIndex",ja.collectionReadTimeIndexPath=["parentPath","readTime"];var Ka=function(t){this.byteSize=t};Ka.store="remoteDocumentGlobal",Ka.key="remoteDocumentGlobalKey";var Ga=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ga.store="targets",Ga.keyPath="targetId",Ga.queryTargetsIndexName="queryTargetsIndex",Ga.queryTargetsKeyPath=["canonicalId","targetId"];var za=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};za.store="targetDocuments",za.keyPath=["targetId","path"],za.documentTargetsIndex="documentTargetsIndex",za.documentTargetsKeyPath=["path","targetId"];var Ha=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ha.key="targetGlobalKey",Ha.store="targetGlobal";var Qa=function(t,e){this.collectionId=t,this.parent=e};Qa.store="collectionParents",Qa.keyPath=["collectionId","parent"];var Wa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Wa.store="clientMetadata",Wa.keyPath="clientId";var Ya=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ya.store="bundles",Ya.keyPath="bundleId";var $a=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};$a.store="namedQueries",$a.keyPath="name";var Xa=u(u([],u(u([],u(u([],u(u([],[Fa.store,Va.store,Ua.store,ja.store,Ga.store,Ma.store,Ha.store,za.store]),[Wa.store])),[Ka.store])),[Qa.store])),[Ya.store,$a.store]),Ja="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Za=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),tu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},eu=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&di(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),nu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new tu,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new ou(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=hu(e.target.error);n.ft.reject(new ou(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ou(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(hi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new au(e)},t}(),ru=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(f())&&li("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return hi("SimpleDb","Removing database:",t),uu(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=f(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){return"undefined"!=typeof process&&"YES"===(null==="MISSING_ENV_VAR"?void 0:"MISSING_ENV_VAR".Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return i(this,void 0,void 0,(function(){var e,n=this;return o(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(hi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ou(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ai(si.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ou(t,n))},i.onupgradeneeded=function(t){hi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){hi("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,a,u,c;return o(this,(function(h){switch(h.label){case 0:i="readonly"===e,s=0,a=function(){var e,a,c,h,l;return o(this,(function(o){switch(o.label){case 0:++s,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=o.sent(),e=nu.open(u.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),eu.reject(t)})).toPromise(),c={},a.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(o.sent(),a),c)];case 4:return h=o.sent(),l="FirebaseError"!==h.name&&s<3,hi("SimpleDb","Transaction failed with error:",h.message,"Retrying:",l),u.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},u=this,h.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),iu=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return uu(this.Pt.delete())},t}(),ou=function(t){function e(e,n){var r=this;return(r=t.call(this,si.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return n(e,t),e}(ai);function su(t){return"IndexedDbTransactionError"===t.name}var au=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(hi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(hi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),uu(n)},t.prototype.add=function(t){return hi("SimpleDb","ADD",this.store.name,t,t),uu(this.store.add(t))},t.prototype.get=function(t){var e=this;return uu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),hi("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return hi("SimpleDb","DELETE",this.store.name,t),uu(this.store.delete(t))},t.prototype.count=function(){return hi("SimpleDb","COUNT",this.store.name),uu(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){hi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new eu((function(n,r){e.onerror=function(t){var e=hu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new eu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new iu(i),s=e(i.primaryKey,i.value,o);if(s instanceof eu){var a=s.catch((function(t){return o.done(),eu.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return eu.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function uu(t){return new eu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=hu(t.target.error);n(e)}}))}var cu=!1;function hu(t){var e=ru._t(f());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ai("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return cu||(cu=!0,setTimeout((function(){throw r}),0)),r}}return t}var lu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return n(e,t),e}(Za);function fu(t,e){var n=vi(t);return ru.It(n.Mt,e)}var pu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&ls(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&fs(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&fs(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Ei.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),qs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&wi(this.mutations,t.mutations,(function(t,e){return ds(t,e)}))&&wi(this.baseMutations,t.baseMutations,(function(t,e){return ds(t,e)}))},t}(),du=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){yi(e.mutations.length===r.length);for(var i=Vs(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),yu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Ei.min()),void 0===o&&(o=Ei.min()),void 0===s&&(s=xi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),vu=function(t){this.Lt=t};function mu(t,e){if(e.document)return da(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ki.fromSegments(e.noDocument.path),r=_u(e.noDocument.readTime),i=so.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ki.fromSegments(e.unknownDocument.path);return r=_u(e.unknownDocument.version),so.newUnknownDocument(o,r)}return di()}function gu(t,e,n){var r=bu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:aa(t,e.key),fields:e.data.value.mapValue.fields,updateTime:ea(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new ja(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Iu(e.version);return s=e.hasCommittedMutations,new ja(null,new qa(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Iu(e.version);return new ja(new Ba(c,h),null,null,!0,r,i)}return di()}function bu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function wu(t){var e=new _i(t[0],t[1]);return Ei.fromTimestamp(e)}function Iu(t){var e=t.toTimestamp();return new Pa(e.seconds,e.nanoseconds)}function _u(t){var e=new _i(t.seconds,t.nanoseconds);return Ei.fromTimestamp(e)}function Eu(t,e){for(var n=(e.baseMutations||[]).map((function(e){return va(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return va(t.Lt,e)})),a=_i.fromMillis(e.localWriteTimeMs);return new pu(e.batchId,a,n,s)}function Tu(t){var e,n,r=_u(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?_u(t.lastLimboFreeSnapshotVersion):Ei.min();return void 0!==t.query.documents?(yi(1===(n=t.query).documents.length),e=Fo(ko(ha(n.documents[0])))):e=function(t){return Fo(ba(t))}(t.query),new yu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,xi.fromBase64String(t.resumeToken))}function Su(t,e){var n,r=Iu(e.snapshotVersion),i=Iu(e.lastLimboFreeSnapshotVersion);n=lo(e.target)?ma(t.Lt,e.target):ga(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ga(e.targetId,co(e.target),r,o,e.sequenceNumber,i,n)}function Au(t){var e=ba({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Vo(e,e.limit,"L"):e}var Nu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Du(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:_u(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Du(t).put({bundleId:(n=e).id,createTime:Iu(ia(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Cu(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Au(e.bundledQuery),readTime:_u(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Cu(t).put(function(t){return{name:t.name,readTime:Iu(ia(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Du(t){return fu(t,Ya.store)}function Cu(t){return fu(t,$a.store)}var ku=function(){function t(){this.Bt=new Ru}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),eu.resolve()},t.prototype.getCollectionParents=function(t,e){return eu.resolve(this.Bt.getEntries(e))},t}(),Ru=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Rs(Di.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Rs(Di.comparator)).toArray()},t}(),xu=function(){function t(){this.qt=new Ru}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Ra(i)};return Ou(t).put(o)}return eu.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ii(e),""],!1,!0);return Ou(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(La(o.parent))}return n}))},t}();function Ou(t){return fu(t,Qa.store)}var Lu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Pu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Mu(t,e,n){var r=t.store(Va.store),i=t.store(Ua.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){yi(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Ua.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return eu.waitFor(o).next((function(){return c}))}function Fu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw di();e=t.noDocument}return JSON.stringify(e).length}Pu.DEFAULT_COLLECTION_PERCENTILE=10,Pu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pu.DEFAULT=new Pu(41943040,Pu.DEFAULT_COLLECTION_PERCENTILE,Pu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pu.DISABLED=new Pu(-1,0,0);var Vu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return yi(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qu(t).$t({index:Va.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Bu(t),s=qu(t);return s.add({}).next((function(a){yi("number"==typeof a);for(var u=new pu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return ya(t.Lt,e)})),i=n.mutations.map((function(e){return ya(t.Lt,e)}));return new Va(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Rs((function(t,e){return bi(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=Ua.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,Ua.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[a]=u.keys()})),eu.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return qu(t).get(e).next((function(t){return t?(yi(t.userId===n.userId),Eu(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?eu.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return qu(t).$t({index:Va.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(yi(e.batchId>=r),o=Eu(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return qu(t).$t({index:Va.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qu(t).Nt(Va.userMutationsIndex,n).next((function(t){return t.map((function(t){return Eu(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ua.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Bu(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=La(u);if(a===n.userId&&e.path.isEqual(h))return qu(t).get(c).next((function(t){if(!t)throw di();yi(t.userId===n.userId),o.push(Eu(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Rs(bi),i=[];return e.forEach((function(e){var o=Ua.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Bu(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=La(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),eu.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ua.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Rs(bi);return Bu(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=La(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(qu(t).get(e).next((function(t){if(null===t)throw di();yi(t.userId===n.userId),r.push(Eu(n.R,t))})))})),eu.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Mu(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),eu.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return eu.resolve();var r=IDBKeyRange.lowerBound(Ua.prefixForUser(e.userId)),i=[];return Bu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=La(t[1]);i.push(o)}else r.done()})).next((function(){yi(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Uu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return ju(t).get(this.userId).next((function(t){return t||new Fa(e.userId,-1,"")}))},t}();function Uu(t,e,n){var r=Ua.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Bu(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function qu(t){return fu(t,Va.store)}function Bu(t){return fu(t,Ua.store)}function ju(t){return fu(t,Fa.store)}var Ku=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Gu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Ku(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Ei.fromTimestamp(new _i(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return zu(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return yi(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return zu(t).$t((function(s,a){var u=Tu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return eu.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return zu(t).$t((function(t,n){var r=Tu(n);e(r)}))},t.prototype.Xt=function(t){return Hu(t).get(Ha.key).next((function(t){return yi(null!==t),t}))},t.prototype.Zt=function(t,e){return Hu(t).put(Ha.key,e)},t.prototype.te=function(t,e){return zu(t).put(Su(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=co(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return zu(t).$t({range:r,index:Ga.queryTargetsIndexName},(function(t,n,r){var o=Tu(n);ho(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Qu(t);return e.forEach((function(e){var s=Ra(e.path);i.push(o.put(new za(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),eu.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Qu(t);return eu.forEach(e,(function(e){var o=Ra(e.path);return eu.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Qu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Qu(t),i=qs();return r.$t({range:n,kt:!0},(function(t,e,n){var r=La(t[1]),o=new Ki(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Ra(e.path),r=IDBKeyRange.bound([n],[Ii(n)],!1,!0),i=0;return Qu(t).$t({index:za.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return zu(t).get(e).next((function(t){return t?Tu(t):null}))},t}();function zu(t){return fu(t,Ga.store)}function Hu(t){return fu(t,Ha.store)}function Qu(t){return fu(t,za.store)}function Wu(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){if(t.code!==si.FAILED_PRECONDITION||t.message!==Ja)throw t;return hi("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function Yu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=bi(n,i);return 0===s?bi(r,o):s}var $u=function(){function t(t){this.ne=t,this.buffer=new Rs(Yu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Yu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Xu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;hi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return su(e=n.sent())?(hi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Wu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Ju=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return eu.resolve(oi.o);var r=new $u(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(hi("LruGarbageCollector","Garbage collection skipped; disabled"),eu.resolve(Lu)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(hi("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Lu):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(hi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),ci()<=C.DEBUG&&hi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),eu.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Zu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Ju(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return tc(t,n)},t.prototype.removeReference=function(t,e,n){return tc(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return tc(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return ju(t).Ot((function(r){return Uu(t,r,e).next((function(t){return t&&(n=!0),eu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Qu(t).delete([0,Ra(s.path)])}))}));i.push(u)}})).next((function(){return eu.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return tc(t,e)},t.prototype.we=function(t,e){var n,r=Qu(t),i=oi.o;return r.$t({index:za.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==oi.o&&e(new Ki(La(n)),i),i=a,n=s):i=oi.o})).next((function(){i!==oi.o&&e(new Ki(La(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function tc(t,e){return Qu(t).put(function(t,e){return new za(0,Ra(t.path),e)}(e,t.currentSequenceNumber))}var ec=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Si(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return Ai(this.inner)},t}(),nc=function(){function t(){this.changes=new ec((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Ei.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:so.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?eu.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),rc=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return sc(t).put(ac(e),n)},t.prototype.removeEntry=function(t,e){var n=sc(t),r=ac(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return sc(t).get(ac(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return sc(t).get(ac(e)).next((function(t){return{document:n.ye(e,t),size:Fu(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Ls();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Ls(),i=new Ds(Ki.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Fu(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return eu.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return sc(t).$t({range:r},(function(t,e,r){for(var s=Ki.fromSegments(t);o&&Ki.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Ls(),o=e.path.length+1,s={};if(n.isEqual(Ei.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=bu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=ja.collectionReadTimeIndex}return sc(t).$t(s,(function(t,n,s){if(t.length===o){var a=mu(r.R,n);e.path.isPrefixOf(a.key.path)?jo(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new ic(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return oc(t).get(Ka.key).next((function(t){return yi(!!t),t}))},t.prototype.me=function(t,e){return oc(t).put(Ka.key,e)},t.prototype.ye=function(t,e){if(e){var n=mu(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Ei.min()))return n}return so.newInvalidDocument(t)},t}(),ic=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new ec((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return n(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Rs((function(t,e){return bi(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=gu(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Fu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=gu(e.Ie.R,so.newNoDocument(o,Ei.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),eu.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(nc);function oc(t){return fu(t,Ka.store)}function sc(t){return fu(t,ja.store)}function ac(t){return t.path.toArray()}var uc=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;yi(n<r&&n>=0&&r<=11);var o=new nu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Ma.store)}(t),function(t){t.createObjectStore(Fa.store,{keyPath:Fa.keyPath}),t.createObjectStore(Va.store,{keyPath:Va.keyPath,autoIncrement:!0}).createIndex(Va.userMutationsIndex,Va.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ua.store)}(t),cc(t),function(t){t.createObjectStore(ja.store)}(t));var s=eu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(za.store),t.deleteObjectStore(Ga.store),t.deleteObjectStore(Ha.store)}(t),cc(t)),s=s.next((function(){return function(t){var e=t.store(Ha.store),n=new Ha(0,0,Ei.min().toTimestamp(),0);return e.put(Ha.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Va.store).Nt().next((function(n){t.deleteObjectStore(Va.store),t.createObjectStore(Va.store,{keyPath:Va.keyPath,autoIncrement:!0}).createIndex(Va.userMutationsIndex,Va.userMutationsKeyPath,{unique:!0});var r=e.store(Va.store),i=n.map((function(t){return r.put(t)}));return eu.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Wa.store,{keyPath:Wa.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Ka.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ja.store);e.createIndex(ja.readTimeIndex,ja.readTimeIndexPath,{unique:!1}),e.createIndex(ja.collectionReadTimeIndex,ja.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath})}(t),function(t){t.createObjectStore($a.store,{keyPath:$a.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(ja.store).$t((function(t,n){e+=Fu(n)})).next((function(){var n=new Ka(e);return t.store(Ka.store).put(Ka.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Fa.store),r=t.store(Va.store);return n.Nt().next((function(n){return eu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Va.userMutationsIndex,i).next((function(r){return eu.forEach(r,(function(r){yi(r.userId===n.userId);var i=Eu(e.R,r);return Mu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(za.store),n=t.store(ja.store);return t.store(Ha.store).get(Ha.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Di(n),s=function(t){return[0,Ra(t)]}(o);r.push(e.get(s).next((function(n){return n?eu.resolve():function(n){return e.put(new za(0,Ra(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return eu.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Qa.store,{keyPath:Qa.keyPath});var n=e.store(Qa.store),r=new Ru,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ra(i)})}};return e.store(ja.store).$t({kt:!0},(function(t,e){var n=new Di(t);return i(n.popLast())})).next((function(){return e.store(Ua.store).$t({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],La(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ga.store);return n.$t((function(t,r){var i=Tu(r),o=Su(e.R,i);return n.put(o)}))},t}();function cc(t){t.createObjectStore(za.store,{keyPath:za.keyPath}).createIndex(za.documentTargetsIndex,za.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath}).createIndex(Ga.queryTargetsIndexName,Ga.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ha.store)}var hc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lc=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new ai(si.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Zu(this,i),this.Le=n+"main",this.R=new vu(u),this.Be=new ru(this.Le,11,new uc(this.R)),this.qe=new Gu(this.referenceDelegate,this.R),this.Ut=new xu,this.Ue=function(t,e){return new rc(t,e)}(this.R,this.Ut),this.Qe=new Nu,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&li("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ai(si.FAILED_PRECONDITION,hc);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new oi(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return i(e,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return pc(e).put(new Wa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(su(e))return hi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return hi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return fc(t).get(Ma.key).next((function(t){return eu.resolve(e.tn(t))}))},t.prototype.en=function(t){return pc(t).delete(this.clientId)},t.prototype.nn=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i=this;return o(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=fu(t,Wa.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return eu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?eu.resolve(!0):fc(t).get(Ma.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new ai(si.FAILED_PRECONDITION,hc);return!1}}return!(!e.networkEnabled||!e.inForeground)||pc(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&hi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ma.store,Wa.store],(function(e){var n=new lu(e,oi.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return pc(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Vu.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;hi("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Xa,(function(o){return i=new lu(o,r.Ne?r.Ne.next():oi.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw li("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new ai(si.FAILED_PRECONDITION,Ja);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return fc(t).get(Ma.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ai(si.FAILED_PRECONDITION,hc)}))},t.prototype.Ze=function(t){var e=new Ma(this.clientId,this.allowTabSynchronization,Date.now());return fc(t).put(Ma.key,e)},t.yt=function(){return ru.yt()},t.prototype.Xe=function(t){var e=this,n=fc(t);return n.get(Ma.key).next((function(t){return e.tn(t)?(hi("IndexedDbPersistence","Releasing primary lease."),n.delete(Ma.key)):eu.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(li("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return hi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return li("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){li("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function fc(t){return fu(t,Ma.store)}function pc(t){return fu(t,Wa.store)}function dc(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var yc=function(t,e){this.progress=t,this.wn=e},vc=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ki.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Po(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ki(e)).next((function(t){var e=Ms();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Ms();return this.Ut.getCollectionParents(t,i).next((function(s){return eu.forEach(s,(function(s){var a=function(t,e){return new Do(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=so.newInvalidDocument(c),r=r.insert(c,h)),fs(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){jo(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=qs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ms&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),mc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=qs(),i=qs(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),gc=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Ei.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Ro(e)||xo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(ci()<=C.DEBUG&&hi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Bo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Rs(Ko(t));return e.forEach((function(e,r){jo(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return ci()<=C.DEBUG&&hi("QueryEngine","Using full collection scan to execute query:",Bo(e)),this.Sn.getDocumentsMatchingQuery(t,e,Ei.min())},t}(),bc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ds(bi),this.kn=new ec((function(t){return co(t)}),ho),this.$n=Ei.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new vc(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function wc(t,e,n,r){return new bc(t,e,n,r)}function Ic(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return n=vi(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new vc(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=qs(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,m=y.mutations;v<m.length;v++){var g=m[v];s=s.add(g.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return s=o.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),s)]}}))}))}function _c(t,e){var n=vi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=eu.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);yi(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Ec(t){var e=vi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Tc(t,e){var n=vi(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return yi(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=Ls();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(Sc(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(Ei.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return eu.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function Sc(t,e,n,r,i){var o=qs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Ls();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(Ei.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):hi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function Ac(t,e){var n=vi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Nc(t,e){var n=vi(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,eu.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new yu(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Dc(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,a;return o(this,(function(o){switch(o.label){case 0:r=vi(t),i=r.Fn.get(e),s=n?"readwrite":"readwrite-primary",o.label=1;case 1:return o.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:if(!su(a=o.sent()))throw a;return hi("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function Cc(t,e,n){var r=vi(t),i=Ei.min(),o=qs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=vi(t),i=r.kn.get(n);return void 0!==i?eu.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Fo(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Ei.min(),n?o:qs())})).next((function(t){return{documents:t,Bn:o}}))}))}function kc(t,e){var n=vi(t),r=vi(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Rc(t){var e=vi(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=vi(t),i=Ls(),o=bu(n),s=sc(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:ja.readTimeIndex,range:a},(function(t,e){var n=mu(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:wu(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function xc(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){return[2,(e=vi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=sc(t),n=Ei.min();return e.$t({index:ja.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=wu(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function Oc(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,a,u,c,h,l,f,p,d;return o(this,(function(o){switch(o.label){case 0:for(i=vi(t),s=qs(),a=Ls(),u=Vs(),c=0,h=n;c<h.length;c++)l=h[c],f=e.qn(l.metadata.name),l.document&&(s=s.add(f)),a=a.insert(f,e.Un(l)),u=u.insert(f,e.Qn(l.metadata.readTime));return p=i.On.newChangeBuffer({trackRemovals:!0}),[4,Nc(i,function(t){return Fo(ko(Di.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=o.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Sc(t,p,a,Ei.min(),u).next((function(e){return p.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,s,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function Lc(t,e,n){return void 0===n&&(n=qs()),i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Nc(t,Fo(Au(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=vi(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=ia(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(xi.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var Pc=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return eu.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:ia(n.createTime)}),eu.resolve()},t.prototype.getNamedQuery=function(t,e){return eu.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Au(t.bundledQuery),readTime:ia(t.readTime)}}(e)),eu.resolve()},t}(),Mc=function(){function t(){this.Wn=new Rs(Fc.Gn),this.zn=new Rs(Fc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Fc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Fc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Ki(new Di([])),r=new Fc(n,t),i=new Fc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ki(new Di([])),n=new Fc(e,t),r=new Fc(e,t+1),i=qs();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Fc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Fc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ki.comparator(t.key,e.key)||bi(t.ns,e.ns)},t.Hn=function(t,e){return bi(t.ns,e.ns)||Ki.comparator(t.key,e.key)},t}(),Vc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Rs(Fc.Gn)}return t.prototype.checkEmpty=function(t){return eu.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new pu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Fc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return eu.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return eu.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return eu.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return eu.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return eu.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Fc(e,0),i=new Fc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),eu.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Rs(bi);return e.forEach((function(t){var e=new Fc(t,0),i=new Fc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),eu.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ki.isDocumentKey(i)||(i=i.child(""));var o=new Fc(new Ki(i),0),s=new Rs(bi);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),eu.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;yi(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return eu.forEach(e.mutations,(function(i){var o=new Fc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Fc(e,0),r=this.rs.firstAfterOrEqual(n);return eu.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,eu.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Uc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ds(Ki.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return eu.resolve(n?n.document.clone():so.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Ls();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():so.newInvalidDocument(t))})),eu.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ls(),i=new Ki(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||jo(e,c)&&(r=r.insert(c.key,c.clone()))}return eu.resolve(r)},t.prototype.fs=function(t,e){return eu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new qc(this)},t.prototype.getSize=function(t){return eu.resolve(this.size)},t}(),qc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return n(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),eu.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(nc),Bc=function(){function t(t){this.persistence=t,this.ds=new ec((function(t){return co(t)}),ho),this.lastRemoteSnapshotVersion=Ei.min(),this.highestTargetId=0,this.ws=0,this._s=new Mc,this.targetCount=0,this.ys=Ku.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),eu.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return eu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return eu.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),eu.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),eu.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Ku(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,eu.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),eu.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,eu.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),eu.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return eu.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return eu.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),eu.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),eu.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),eu.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return eu.resolve(n)},t.prototype.containsKey=function(t,e){return eu.resolve(this._s.containsKey(e))},t}(),jc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new oi(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Bc(this),this.Ut=new ku,this.Ue=function(t,e){return new Uc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new vu(e),this.Qe=new Pc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Vc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;hi("MemoryPersistence","Starting transaction:",t);var i=new Kc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return eu.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Kc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return n(e,t),e}(Za),Gc=function(){function t(t){this.persistence=t,this.As=new Mc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw di()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),eu.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),eu.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),eu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return eu.forEach(this.vs,(function(r){var i=Ki.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return eu.or([function(){return eu.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),zc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Hc(t,e){return"firestore_clients_"+t+"_"+e}function Qc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Wc(t,e){return"firestore_targets_"+t+"_"+e}zc.UNAUTHENTICATED=new zc(null),zc.GOOGLE_CREDENTIALS=new zc("google-credentials-uid"),zc.FIRST_PARTY=new zc("first-party-uid");var Yc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new ai(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(li("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),$c=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ai(i.error.code,i.error.message)),o?new t(e,i.state,r):(li("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Xc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=js(),s=0;i&&s<r.activeTargetIds.length;++s)i=ji(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(li("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Jc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(li("SharedClientState","Failed to parse online state: "+e),null)},t}(),Zc=function(){function t(){this.activeTargetIds=js()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),th=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ds(bi),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Hc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Zc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i,s,a,u,c,h,l,f=this;return o(this,(function(o){switch(o.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=o.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Hc(this.persistenceKey,r)))&&(s=Xc.Vs(r,i))&&(this.ks=this.ks.insert(s.clientId,s));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(u=this.js(a))&&this.Ws(u),c=0,h=this.$s;c<h.length;c++)l=h[c],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Wc(this.persistenceKey,t));if(n){var r=$c.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Wc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return hi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){hi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){hi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(hi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void li("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return i(e,void 0,void 0,(function(){var t,e,r,i,s,a;return o(this,(function(o){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(s=this.js(n.newValue)))return[2,this.Ws(s)]}else if(n.key===this.Ms)(a=function(t){var e=oi.o;if(null!=t)try{var n=JSON.parse(t);yi("number"==typeof n),e=n}catch(t){li("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==oi.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Yc(this.currentUser,t,e,n),i=Qc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Qc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Wc(this.persistenceKey,t),i=new $c(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Xc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Yc.Vs(new zc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return $c.Vs(r,e)},t.prototype.js=function(t){return Jc.Vs(t)},t.prototype.ii=function(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(hi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=js();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),eh=function(){function t(){this.li=new Zc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Zc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),nh=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),rh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){hi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){hi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ih={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},oh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),sh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return n(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new ii;s.listenOnce(Zr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Jr.NO_ERROR:var e=s.getResponseJson();hi("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Jr.TIMEOUT:hi("Connection",'RPC "'+t+'" timed out'),o(new ai(si.DEADLINE_EXCEEDED,"Request time out"));break;case Jr.HTTP_ERROR:var n=s.getStatus();if(hi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(si).indexOf(e)>=0?e:si.UNKNOWN}(r.status);o(new ai(a,r.message))}else o(new ai(si.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ai(si.UNAVAILABLE,"Connection failed."));break;default:di()}}finally{hi("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Qr,o=We(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product||f().indexOf("Electron/")>=0||function(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||f().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");hi("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new oh({Ei:function(t){h?hi("Connection","Not sending because WebChannel is closed:",t):(c||(hi("Connection","Opening WebChannel transport."),u.open(),c=!0),hi("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),p=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return p(u,ri.EventType.OPEN,(function(){h||hi("Connection","WebChannel transport opened.")})),p(u,ri.EventType.CLOSE,(function(){h||(h=!0,hi("Connection","WebChannel transport closed"),l.Vi())})),p(u,ri.EventType.ERROR,(function(t){h||(h=!0,fi("Connection","WebChannel transport errored:",t),l.Vi(new ai(si.UNAVAILABLE,"The operation could not be completed")))})),p(u,ri.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];yi(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){hi("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Is[t];if(void 0!==e)return Ns(e)}(o),a=i.message;void 0===s&&(s=si.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new ai(s,a)),u.close()}else hi("Connection","WebChannel received:",n),l.Si(n)}})),p(o,ti.STAT_EVENT,(function(t){t.stat===ei?hi("Connection","Detected buffering proxy"):t.stat===ni&&hi("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);hi("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return hi("RestConnection","Received: ",t),t}),(function(e){throw fi("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.3",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=ih[t];return this.Di+"/v1/"+e+":"+n},t}());function ah(){return"undefined"!=typeof window?window:null}function uh(){return"undefined"!=typeof document?document:null}function ch(t){return new ta(t,!0)}var hh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&hi("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),lh=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new hh(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===si.RESOURCE_EXHAUSTED?(li(e.toString()),li("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===si.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new ai(si.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return i(t,void 0,void 0,(function(){return o(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return hi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(hi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),fh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return n(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:di()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(yi(void 0===e||"string"==typeof e),xi.fromBase64String(e||"")):(yi(void 0===e||e instanceof Uint8Array),xi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?si.UNKNOWN:Ns(t.code);return new ai(e,t.message||"")}(a);n=new Qs(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=ua(t,r.document.name),o=ia(r.document.updateTime);var a=new io({mapValue:{fields:r.document.fields}}),u=(s=so.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new zs(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=ua(t,r.document),o=r.readTime?ia(r.readTime):Ei.min(),a=so.newNoDocument(i,o),s=r.removedTargetIds||[],n=new zs([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=ua(t,r.document),o=r.removedTargetIds||[],n=new zs([],o,i,null);else{if(!("filter"in e))return di();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Ss(r),o=h.targetId,n=new Hs(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ei.min():e.readTime?ia(e.readTime):Ei.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=la(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=lo(r)?{documents:ma(t,r)}:{query:ga(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=na(t,e.resumeToken):e.snapshotVersion.compareTo(Ei.min())>0&&(n.readTime=ea(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return di()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=la(this.R),e.removeTarget=t,this.cr(e)},e}(lh),ph=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return n(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(yi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(yi(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ia(t.updateTime):ia(e);return n.isEqual(Ei.min())&&(n=ia(e)),new as(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ia(t.commitTime);return this.listener.Tr(n,e)}return yi(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=la(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return ya(e.R,t)}))};this.cr(n)},e}(lh),dh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return n(e,t),e.prototype.br=function(){if(this.Rr)throw new ai(si.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===si.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ai(si.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===si.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new ai(si.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),yh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(li(e),this.Vr=!1):hi("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),vh=function(t,e,n,r,s){var a=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=s,this.Lr.di((function(t){n.enqueueAndForget((function(){return i(a,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return Sh(this)?(hi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return(e=vi(t)).Or.add(4),[4,gh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,mh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new yh(n,r)};function mh(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:if(!Sh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function gh(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function bh(t,e){var n=vi(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Th(n)?Eh(n):qh(n).er()&&Ih(n,e))}function wh(t,e){var n=vi(t),r=qh(n);n.$r.delete(e),r.er()&&_h(n,e),0===n.$r.size&&(r.er()?r.ir():Sh(n)&&n.Br.set("Unknown"))}function Ih(t,e){t.qr.U(e.targetId),qh(t).mr(e)}function _h(t,e){t.qr.U(e),qh(t).yr(e)}function Eh(t){t.qr=new Ys({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),qh(t).start(),t.Br.Sr()}function Th(t){return Sh(t)&&!qh(t).tr()&&t.$r.size>0}function Sh(t){return 0===vi(t).Or.size}function Ah(t){t.qr=void 0}function Nh(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return t.$r.forEach((function(e,n){Ih(t,e)})),[2]}))}))}function Dh(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){return Ah(t),Th(t)?(t.Br.Nr(e),Eh(t)):t.Br.set("Unknown"),[2]}))}))}function Ch(t,e,n){return i(this,void 0,void 0,(function(){var r,s,a;return o(this,(function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof Qs&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:n=e.cause,r=0,i=e.targetIds,o.label=1;case 1:return r<i.length?(s=i[r],t.$r.has(s)?[4,t.remoteSyncer.rejectListen(s,n)]:[3,3]):[3,5];case 2:o.sent(),t.$r.delete(s),t.qr.removeTarget(s),o.label=3;case 3:o.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),hi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,kh(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof zs?t.qr.X(e):e instanceof Hs?t.qr.rt(e):t.qr.et(e),n.isEqual(Ei.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Ec(t.localStore)];case 8:return s=u.sent(),n.compareTo(s)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(xi.EMPTY_BYTE_STRING,n.snapshotVersion)),_h(t,e);var r=new yu(n.target,e,1,n.sequenceNumber);Ih(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return hi("RemoteStore","Failed to raise snapshot:",a=u.sent()),[4,kh(t,a)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function kh(t,e,n){return i(this,void 0,void 0,(function(){var r=this;return o(this,(function(s){switch(s.label){case 0:if(!su(e))throw e;return t.Or.add(1),[4,gh(t)];case 1:return s.sent(),t.Br.set("Offline"),n||(n=function(){return Ec(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return i(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return hi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,mh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Rh(t,e){return e().catch((function(n){return kh(t,n,e)}))}function xh(t){return i(this,void 0,void 0,(function(){var e,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:e=vi(t),n=Bh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,o.label=1;case 1:if(!function(t){return Sh(t)&&t.kr.length<10}(e))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,Ac(e.localStore,r)];case 3:return null===(i=o.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Bh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return s=o.sent(),[4,kh(e,s)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return Oh(e)&&Lh(e),[2]}}))}))}function Oh(t){return Sh(t)&&!Bh(t).tr()&&t.kr.length>0}function Lh(t){Bh(t).start()}function Ph(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return Bh(t).Ar(),[2]}))}))}function Mh(t){return i(this,void 0,void 0,(function(){var e,n,r,i;return o(this,(function(o){for(e=Bh(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Fh(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=du.from(r,e,n),[4,Rh(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,xh(t)];case 2:return o.sent(),[2]}}))}))}function Vh(t,e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return e&&Bh(t).pr?[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return As(r=e.code)&&r!==si.ABORTED?(n=t.kr.shift(),Bh(t).sr(),[4,Rh(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,xh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Oh(t)&&Lh(t),[2]}}))}))}function Uh(t,e){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=vi(t),e?(n.Or.delete(2),[4,mh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,gh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function qh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=vi(t);return r.br(),new fh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Nh.bind(null,t),Ri:Dh.bind(null,t),_r:Ch.bind(null,t)}),t.Mr.push((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Th(t)?Eh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Ah(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Bh(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=vi(t);return r.br(),new ph(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Ph.bind(null,t),Ri:Vh.bind(null,t),Ir:Mh.bind(null,t),Tr:Fh.bind(null,t)}),t.Mr.push((function(n){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,xh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(hi("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var jh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new tu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ai(si.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Kh(t,e){if(li("AsyncQueue",e+": "+t),su(t))return new ai(si.UNAVAILABLE,e+": "+t);throw t}var Gh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ki.comparator(e.key,n.key)}:function(t,e){return Ki.comparator(t.key,e.key)},this.keyedMap=Ms(),this.sortedSet=new Ds(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),zh=function(){function t(){this.Kr=new Ds(Ki.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):di():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Hh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Gh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Uo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Qh=function(){this.Wr=void 0,this.listeners=[]},Wh=function(){this.queries=new ec((function(t){return qo(t)}),Uo),this.onlineState="Unknown",this.Gr=new Set};function Yh(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u,c;return o(this,(function(o){switch(o.label){case 0:if(n=vi(t),r=e.query,i=!1,(s=n.queries.get(r))||(i=!0,s=new Qh),!i)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),a=s,[4,n.onListen(r)];case 2:return a.Wr=o.sent(),[3,4];case 3:return u=o.sent(),c=Kh(u,"Initialization of query '"+Bo(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.zr(n.onlineState),s.Wr&&e.Hr(s.Wr)&&Zh(n),[2]}}))}))}function $h(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a;return o(this,(function(o){return n=vi(t),r=e.query,i=!1,(s=n.queries.get(r))&&(a=s.listeners.indexOf(e))>=0&&(s.listeners.splice(a,1),i=0===s.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Xh(t,e){for(var n=vi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Zh(n)}function Jh(t,e,n){var r=vi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Zh(t){t.Gr.forEach((function(t){t.next()}))}var tl=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Hh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Hh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),el=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),nl=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return ua(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?da(this.R,t.document,!1):so.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return ia(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new nl(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||qs()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return i(this,void 0,void 0,(function(){var t,e,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Oc(this.localStore,new nl(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Lc(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new yc(Object.assign({},this.progress),t))]}}))}))}}();var rl=function(t){this.key=t},il=function(t){this.key=t},ol=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=qs(),this.mutatedKeys=qs(),this.lo=Ko(t),this.fo=new Gh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new zh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Ro(this.query)&&i.size===this.query.limit?i.last():null,c=xo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=jo(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ro(this.query)||xo(this.query))for(;s.size>this.query.limit;){var h=Ro(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return di()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Hh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new zh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=qs(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new il(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new rl(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=qs();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Hh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),sl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},al=function(t){this.key=t,this.bo=!1},ul=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new ec((function(t){return qo(t)}),Uo),this.Vo=new Map,this.So=new Set,this.Do=new Ds(Ki.comparator),this.Co=new Map,this.No=new Mc,this.xo={},this.Fo=new Map,this.ko=Ku.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function cl(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:return n=Vl(t),(s=n.Po.get(e))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro(),[3,4]):[3,1];case 1:return[4,Nc(n.localStore,Fo(e))];case 2:return a=o.sent(),u=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,hl(n,e,r,"current"===u)];case 3:i=o.sent(),n.isPrimaryClient&&bh(n.remoteStore,a),o.label=4;case 4:return[2,i]}}))}))}function hl(t,e,n,r){return i(this,void 0,void 0,(function(){var s,a,u,c,h,l;return o(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,a;return o(this,(function(o){switch(o.label){case 0:return(i=e.view._o(n)).Nn?[4,Cc(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return s=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,s),[2,(El(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,Cc(t.localStore,e,!0)];case 1:return s=f.sent(),a=new ol(e,s.Bn),u=a._o(s.documents),c=Gs.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),h=a.applyChanges(u,t.isPrimaryClient,c),El(t,n,h.To),l=new sl(e,n,a),[2,(t.Po.set(e,l),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),h.snapshot)]}}))}))}function ll(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=vi(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Uo(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Dc(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),wh(n.remoteStore,r.targetId),Il(n,r.targetId)})).catch(Wu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Il(n,r.targetId),[4,Dc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function fl(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,a;return o(this,(function(o){switch(o.label){case 0:r=Ul(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,function(t,e){var n,r=vi(t),i=_i.now(),o=e.reduce((function(t,e){return t.add(e.key)}),qs());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=ps(c,n.get(c.key));null!=h&&s.push(new ms(c.key,h,oo(h.value.mapValue),us.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=o.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ds(bi)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Al(r,i.changes)];case 3:return o.sent(),[4,xh(r.remoteStore)];case 4:return o.sent(),[3,6];case 5:return s=o.sent(),a=Kh(s,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function pl(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:n=vi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Tc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(yi(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?yi(r.bo):t.removedDocuments.size>0&&(yi(r.bo),r.bo=!1))})),[4,Al(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Wu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function dl(t,e,n){var r=vi(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=vi(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Zh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function yl(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,a,u,c;return o(this,(function(o){switch(o.label){case 0:return(r=vi(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(s=i&&i.key)?(a=(a=new Ds(Ki.comparator)).insert(s,so.newNoDocument(s,Ei.min())),u=qs().add(s),c=new Ks(Ei.min(),new Map,new Rs(bi),a,u),[4,pl(r,c)]):[3,2];case 1:return o.sent(),r.Do=r.Do.remove(s),r.Co.delete(e),Sl(r),[3,4];case 2:return[4,Dc(r.localStore,e,!1).then((function(){return Il(r,e,n)})).catch(Wu)];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))}function vl(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:n=vi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,_c(n.localStore,e)];case 2:return i=o.sent(),wl(n,r,null),bl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Al(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Wu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ml(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:r=vi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=vi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return yi(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),wl(r,e,n),bl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Al(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Wu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function gl(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:Sh((n=vi(t)).remoteStore)||hi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,function(t){var e=vi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return s=o.sent(),a=Kh(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function bl(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function wl(t,e,n){var r=vi(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Il(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||_l(t,e)}))}function _l(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(wh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Sl(t))}function El(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof rl?(t.No.addReference(o.key,e),Tl(t,o)):o instanceof il?(hi("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||_l(t,o.key)):di()}}function Tl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(hi("SyncEngine","New document in limbo: "+n),t.So.add(r),Sl(t))}function Sl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ki(Di.fromString(e)),r=t.ko.next();t.Co.set(r,new al(n)),t.Do=t.Do.insert(n,r),bh(t.remoteStore,new yu(Fo(ko(n.path)),r,2,oi.o))}}function Al(t,e,n){return i(this,void 0,void 0,(function(){var r,s,a,u;return o(this,(function(c){switch(c.label){case 0:return r=vi(t),s=[],a=[],u=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,i){u.push(r.Oo(i,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(i.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=mc.Pn(i.targetId,t);a.push(e)}})))})),[4,Promise.all(u)]);case 1:return c.sent(),r.vo._r(s),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,h,l;return o(this,(function(o){switch(o.label){case 0:n=vi(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return eu.forEach(e,(function(e){return eu.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return eu.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return o.sent(),[3,4];case 3:if(!su(r=o.sent()))throw r;return hi("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,s=e;i<s.length;i++)a=s[i],u=a.targetId,a.fromCache||(c=n.Fn.get(u),h=c.snapshotVersion,l=c.withLastLimboFreeSnapshotVersion(h),n.Fn=n.Fn.insert(u,l));return[2]}}))}))}(r.localStore,a)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Nl(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return(n=vi(t)).currentUser.isEqual(e)?[3,3]:(hi("SyncEngine","User change. New user:",e.toKey()),[4,Ic(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new ai(si.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Al(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Dl(t,e){var n=vi(t),r=n.Co.get(e);if(r&&r.bo)return qs().add(r.key);var i=qs(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Cl(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,Cc((n=vi(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&El(n,e.targetId,i.To),i)]}}))}))}function kl(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){return[2,Rc((e=vi(t)).localStore).then((function(t){return Al(e,t)}))]}))}))}function Rl(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s;return o(this,(function(o){switch(o.label){case 0:return[4,function(t,e){var n=vi(t),r=vi(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):eu.resolve(null)}))}))}((i=vi(t)).localStore,e)];case 1:return null===(s=o.sent())?[3,6]:"pending"!==n?[3,3]:[4,xh(i.remoteStore)];case 2:return o.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(wl(i,e,r||null),bl(i,e),function(t,e){vi(vi(t)._n).Gt(e)}(i.localStore,e)):di(),o.label=4;case 4:return[4,Al(i,s)];case 5:return o.sent(),[3,7];case 6:hi("SyncEngine","Cannot apply mutation batch with id: "+e),o.label=7;case 7:return[2]}}))}))}function xl(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,h;return o(this,(function(o){switch(o.label){case 0:return Vl(n=vi(t)),Ul(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Ol(n,r.toArray())]);case 1:return i=o.sent(),n.$o=!0,[4,Uh(n.remoteStore,!0)];case 2:for(o.sent(),s=0,a=i;s<a.length;s++)u=a[s],bh(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],h=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):h=h.then((function(){return Il(n,e),Dc(n.localStore,e,!0)})),wh(n.remoteStore,e)})),[4,h]);case 4:return o.sent(),[4,Ol(n,c)];case 5:return o.sent(),function(t){var e=vi(t);e.Co.forEach((function(t,n){wh(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Ds(Ki.comparator)}(n),n.$o=!1,[4,Uh(n.remoteStore,!1)];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))}function Ol(t,e,n){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,h,l,f,p,d,y,v;return o(this,(function(o){switch(o.label){case 0:n=vi(t),r=[],i=[],s=0,a=e,o.label=1;case 1:return s<a.length?(u=a[s],c=void 0,(h=n.Vo.get(u))&&0!==h.length?[4,Nc(n.localStore,Fo(h[0]))]:[3,7]):[3,13];case 2:c=o.sent(),l=0,f=h,o.label=3;case 3:return l<f.length?(p=f[l],d=n.Po.get(p),[4,Cl(n,d)]):[3,6];case 4:(y=o.sent()).snapshot&&i.push(y.snapshot),o.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,kc(n.localStore,u)];case 8:return v=o.sent(),[4,Nc(n.localStore,v)];case 9:return c=o.sent(),[4,hl(n,Ll(v),u,!1)];case 10:o.sent(),o.label=11;case 11:r.push(c),o.label=12;case 12:return s++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function Ll(t){return Co(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Pl(t){var e=vi(t);return vi(vi(e.localStore).persistence).fn()}function Ml(t,e,n,r){return i(this,void 0,void 0,(function(){var i,s,a;return o(this,(function(o){switch(o.label){case 0:return(i=vi(t)).$o?(hi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Rc(i.localStore)];case 3:return s=o.sent(),a=Ks.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Al(i,s,a)];case 4:return o.sent(),[3,8];case 5:return[4,Dc(i.localStore,e,!0)];case 6:return o.sent(),Il(i,e,r),[3,8];case 7:di(),o.label=8;case 8:return[2]}}))}))}function Fl(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,a,u,c,h,l,f,p;return o(this,(function(d){switch(d.label){case 0:if(!(r=Vl(t)).$o)return[3,10];i=0,s=e,d.label=1;case 1:return i<s.length?(a=s[i],r.Vo.has(a)?(hi("SyncEngine","Adding an already active target "+a),[3,5]):[4,kc(r.localStore,a)]):[3,6];case 2:return u=d.sent(),[4,Nc(r.localStore,u)];case 3:return c=d.sent(),[4,hl(r,Ll(u),c.targetId,!1)];case 4:d.sent(),bh(r.remoteStore,c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return o(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Dc(r.localStore,t,!1).then((function(){wh(r.remoteStore,t),Il(r,t)})).catch(Wu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Vl(t){var e=vi(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yl.bind(null,e),e.vo._r=Xh.bind(null,e.eventManager),e.vo.Mo=Jh.bind(null,e.eventManager),e}function Ul(t){var e=vi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ml.bind(null,e),e}var ql=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.R=ch(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return wc(this.persistence,new gc,t.initialUser,this.R)},t.prototype.qo=function(t){return new jc(Gc.bs,this.R)},t.prototype.Bo=function(t){return new eh},t.prototype.terminate=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return n(e,t),e.prototype.initialize=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,xc(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,Ul(this.Ko.syncEngine)];case 4:return n.sent(),[4,xh(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return wc(this.persistence,new gc,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Xu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=dc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Pu.withCacheSize(this.cacheSizeBytes):Pu.DEFAULT;return new lc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,ah(),uh(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new eh},e}(ql),jl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return n(e,t),e.prototype.initialize=function(e){return i(this,void 0,void 0,(function(){var n,r=this;return o(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof th?(this.sharedClientState.syncEngine={ui:Rl.bind(null,n),ai:Ml.bind(null,n),hi:Fl.bind(null,n),fn:Pl.bind(null,n),ci:kl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.He((function(t){return i(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,xl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=ah();if(!th.yt(e))throw new ai(si.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=dc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new th(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Bl),Kl=function(){function t(){}return t.prototype.initialize=function(t,e){return i(this,void 0,void 0,(function(){var n=this;return o(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return dl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Nl.bind(null,this.syncEngine),[4,Uh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Wh},t.prototype.createDatastore=function(t){var e,n=ch(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new sh(e));return function(t,e,n){return new dh(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return dl(s.syncEngine,t,0)},o=rh.yt()?new rh:new nh,new vh(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new ul(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=vi(t),hi("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,gh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),Gl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),zl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new tu,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return i(this,void 0,void 0,(function(){var t,e,n,r;return o(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new el(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return i(this,void 0,void 0,(function(){var t,e;return o(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return i(this,void 0,void 0,(function(){var t,e;return o(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return i(this,void 0,void 0,(function(){var e,n=this;return o(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new ai(si.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:return n=vi(t),r=la(n.R)+"/documents",i={documents:e.map((function(t){return aa(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return s=o.sent(),a=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){yi(!!e.found),e.found.name,e.found.updateTime;var n=ua(t,e.found.name),r=ia(e.found.updateTime),i=new io({mapValue:{fields:e.found.fields}});return so.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){yi(!!e.missing),yi(!!e.readTime);var n=ua(t,e.missing),r=ia(e.readTime);return so.newNoDocument(n,r)}(t,e):di()}(n.R,t);a.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());yi(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Es(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return i(this,void 0,void 0,(function(){var t,e=this;return o(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Ki.fromPath(n);e.mutations.push(new Ts(r,e.precondition(r)))})),[4,function(t,e){return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=vi(t),r=la(n.R)+"/documents",i={writes:e.map((function(t){return ya(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw di();e=Ei.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ai(si.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?us.updateTime(e):us.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ei.min()))throw new ai(si.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return us.updateTime(e)}return us.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Hl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new hh(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return i(t,void 0,void 0,(function(){var t,e,n=this;return o(this,(function(r){return t=new zl(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!qi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!As(e)}return!1},t}(),Ql=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=zc.UNAUTHENTICATED,this.clientId=gi.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return i(r,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return hi("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new ai(si.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new tu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return i(t,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Kh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function Wl(t,e){return i(this,void 0,void 0,(function(){var n,r,s=this;return o(this,(function(a){switch(a.label){case 0:return t.asyncQueue.verifyOperationInProgress(),hi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=a.sent(),[4,e.initialize(n)];case 2:return a.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return i(s,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Ic(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Yl(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(s){switch(s.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,$l(t)];case 1:return n=s.sent(),hi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=s.sent(),[4,e.initialize(n,r)];case 3:return s.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:return(n=vi(t)).asyncQueue.verifyOperationInProgress(),hi("RemoteStore","RemoteStore received new credentials"),r=Sh(n),n.Or.add(3),[4,gh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,mh(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function $l(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(hi("FirestoreClient","Using default OfflineComponentProvider"),[4,Wl(t,new ql)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Xl(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(hi("FirestoreClient","Using default OnlineComponentProvider"),[4,Yl(t,new Kl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Jl(t){return $l(t).then((function(t){return t.persistence}))}function Zl(t){return $l(t).then((function(t){return t.localStore}))}function tf(t){return Xl(t).then((function(t){return t.remoteStore}))}function ef(t){return Xl(t).then((function(t){return t.syncEngine}))}function nf(t){return i(this,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,Xl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=cl.bind(null,e.syncEngine),n.onUnlisten=ll.bind(null,e.syncEngine),n)]}}))}))}function rf(t,e,n){var r=this;void 0===n&&(n={});var s=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Gl({next:function(o){e.enqueueAndForget((function(){return $h(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new ai(si.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new ai(si.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new tl(ko(n.path),o,{includeMetadataChanges:!0,so:!0});return Yh(t,s)},[4,nf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}function of(t,e,n){var r=this;void 0===n&&(n={});var s=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Gl({next:function(n){e.enqueueAndForget((function(){return $h(t,s)})),n.fromCache&&"server"===r.source?i.reject(new ai(si.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new tl(n,o,{includeMetadataChanges:!0,so:!0});return Yh(t,s)},[4,nf(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,s])]}}))}))})),s.promise}var sf=function(t,e,n,r,i,o,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s},af=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),uf=new Map,cf=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},hf=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(zc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),lf=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),ff=function(){function t(t){var e=this;this.currentUser=zc.UNAUTHENTICATED,this.oc=new tu,this.cc=0,this.changeListener=function(){return Promise.resolve()},this.uc=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.ac=function(){e.cc++,e.currentUser=e.hc(),e.oc.resolve(),e.uc&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){hi("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.lc(),e.auth.addAuthTokenListener(e.ac)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):e.uc&&(hi("FirebaseCredentialsProvider","Auth not yet detected"),e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)})))}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(hi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(yi("string"==typeof n.accessToken),new cf(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){this.uc=!0,this.asyncQueue=t,this.changeListener=e},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.ac),this.changeListener=function(){return Promise.resolve()}},t.prototype.hc=function(){var t=this.auth&&this.auth.getUid();return yi(null===t||"string"==typeof t),new zc(t)},t.prototype.lc=function(){var t=this;this.uc&&(this.uc=!1,this.asyncQueue.enqueueRetryable((function(){return i(t,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,this.changeListener(this.currentUser)];case 2:return t.sent(),this.uc=!0,[2]}}))}))})))},t}(),pf=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n,this.type="FirstParty",this.user=zc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.dc},e=this.fc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.wc&&(t["X-Goog-Iam-Authorization-Token"]=this.wc),t},enumerable:!1,configurable:!0}),t}(),df=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n}return t.prototype.getToken=function(){return Promise.resolve(new pf(this.fc,this.dc,this.wc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(zc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function yf(t,e,n){if(!n)throw new ai(si.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function vf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ai(si.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function mf(t,e,n,r){if(!0===e&&!0===r)throw new ai(si.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function gf(t){if(!Ki.isDocumentKey(t))throw new ai(si.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function bf(t){if(Ki.isDocumentKey(t))throw new ai(si.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function wf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":di()}function If(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ai(si.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=wf(t);throw new ai(si.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function _f(t,e){if(e<=0)throw new ai(si.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Ef=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ai(si.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ai(si.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,mf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Tf=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ef({}),this._settingsFrozen=!1,t instanceof af?(this._databaseId=t,this._credentials=new hf):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ai(si.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new af(t.options.projectId)}(t),this._credentials=new ff(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new ai(si.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new ai(si.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ef(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new hf;switch(t.type){case"gapi":var e=t.client;return yi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new df(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new ai(si.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=uf.get(this))&&(hi("ComponentProvider","Removing Datastore"),uf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Sf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Nf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Af=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Nf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ko(r))||this)._path=r,i.type="collection",i}return n(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Sf(this.firestore,null,new Ki(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Af);function Df(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=_(t),yf("collection","path",e),t instanceof Tf)return bf(n=Di.fromString.apply(Di,u([e],r))),new Nf(t,null,n);if(!(t instanceof Sf||t instanceof Nf))throw new ai(si.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return bf(n=Di.fromString.apply(Di,u([t.path],r)).child(Di.fromString(e))),new Nf(t.firestore,null,n)}function Cf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=_(t),1===arguments.length&&(e=gi.u()),yf("doc","path",e),t instanceof Tf)return gf(n=Di.fromString.apply(Di,u([e],r))),new Sf(t,null,new Ki(n));if(!(t instanceof Sf||t instanceof Nf))throw new ai(si.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return gf(n=t._path.child(Di.fromString.apply(Di,u([e],r)))),new Sf(t.firestore,t instanceof Nf?t.converter:null,new Ki(n))}function kf(t,e){return t=_(t),e=_(e),(t instanceof Sf||t instanceof Nf)&&(e instanceof Sf||e instanceof Nf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Rf(t,e){return t=_(t),e=_(e),t instanceof Af&&e instanceof Af&&t.firestore===e.firestore&&Uo(t._query,e._query)&&t.converter===e.converter}var xf=function(){function t(){var t=this;this._c=Promise.resolve(),this.mc=[],this.yc=!1,this.gc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new hh(this,"async_queue_retry"),this.Ac=function(){var e=uh();e&&hi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=uh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ac)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.yc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Rc(),this.bc(t)},t.prototype.enterRestrictedMode=function(){if(!this.yc){this.yc=!0;var t=uh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ac)}},t.prototype.enqueue=function(t){return this.Rc(),this.yc?new Promise((function(t){})):this.bc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.mc.push(t),e.vc()}))},t.prototype.vc=function(){return i(this,void 0,void 0,(function(){var t,e=this;return o(this,(function(n){switch(n.label){case 0:if(0===this.mc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.mc[0]()];case 2:return n.sent(),this.mc.shift(),this.Zi.reset(),[3,4];case 3:if(!su(t=n.sent()))throw t;return hi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.mc.length>0&&this.Zi.ji((function(){return e.vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.bc=function(t){var e=this,n=this._c.then((function(){return e.Tc=!0,t().catch((function(t){throw e.Ec=t,e.Tc=!1,li("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Tc=!1,t}))}));return this._c=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Rc(),this.Ic.indexOf(t)>-1&&(e=0);var i=jh.createAndSchedule(this,t,e,n,(function(t){return r.Pc(t)}));return this.gc.push(i),i},t.prototype.Rc=function(){this.Ec&&di()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Vc=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return[4,t=this._c];case 1:e.sent(),e.label=2;case 2:if(t!==this._c)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Sc=function(t){for(var e=0,n=this.gc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Dc=function(t){var e=this;return this.Vc().then((function(){e.gc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.gc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Vc()}))},t.prototype.Cc=function(t){this.Ic.push(t)},t.prototype.Pc=function(t){var e=this.gc.indexOf(t);this.gc.splice(e,1)},t}();function Of(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new tu,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var Lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new xf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return n(e,t),e.prototype._terminate=function(){return this._firestoreClient||Mf(this),this._firestoreClient.terminate()},e}(Tf);function Pf(t){return t._firestoreClient||Mf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Mf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new sf(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ql(t._credentials,t._queue,r)}function Ff(t,e,n){var r=this,s=new tu;return t.asyncQueue.enqueue((function(){return i(r,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Wl(t,n)];case 1:return i.sent(),[4,Yl(t,e)];case 2:return i.sent(),s.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===si.FAILED_PRECONDITION||t.code===si.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=i.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return s.promise}))}function Vf(t){if(t._initialized||t._terminated)throw new ai(si.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Uf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new ai(si.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ki(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),qf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(xi.fromBase64String(e))}catch(e){throw new ai(si.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(xi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Bf=function(t){this._methodName=t},jf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ai(si.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ai(si.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return bi(this._lat,t._lat)||bi(this._long,t._long)},t}(),Kf=/^__.*__$/,Gf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new ms(t,this.data,this.fieldMask,e,this.fieldTransforms):new vs(t,this.data,e,this.fieldTransforms)},t}(),zf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new ms(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Hf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw di()}}var Qf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xc",{get:function(){return this.settings.xc},enumerable:!1,configurable:!0}),t.prototype.Fc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,$c:!1});return r.Oc(t),r},t.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,$c:!1});return r.Nc(),r},t.prototype.Lc=function(t){return this.Fc({path:void 0,$c:!0})},t.prototype.Bc=function(t){return pp(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Uc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Nc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Oc(this.path.get(t))},t.prototype.Oc=function(t){if(0===t.length)throw this.Bc("Document fields must not be empty");if(Hf(this.xc)&&Kf.test(t))throw this.Bc('Document fields cannot begin and end with "__"')},t}(),Wf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||ch(t)}return t.prototype.Qc=function(t,e,n,r){return void 0===r&&(r=!1),new Qf({xc:t,methodName:e,Uc:n,path:ki.emptyPath(),$c:!1,qc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Yf(t){var e=t._freezeSettings(),n=ch(t._databaseId);return new Wf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $f(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,i);cp("Data must be an object, but it was:",s,r);var a,u,c=ap(r,s);if(o.merge)a=new Ri(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=hp(e,f[l],n);if(!s.contains(p))throw new ai(si.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");dp(h,p)||h.push(p)}a=new Ri(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Gf(new io(c),a,u)}var Xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.xc)throw 1===t.xc?t.Bc(this._methodName+"() can only appear at the top level of your update data"):t.Bc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Bf);function Jf(t,e,n){return new Qf({xc:3,Uc:e.settings.Uc,methodName:t._methodName,$c:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype._toFieldTransform=function(t){return new ss(t.path,new Jo)},e.prototype.isEqual=function(t){return t instanceof e},e}(Bf),tp=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return n(e,t),e.prototype._toFieldTransform=function(t){var e=Jf(this,t,!0),n=this.Kc.map((function(t){return sp(t,e)})),r=new Zo(n);return new ss(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Bf),ep=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return n(e,t),e.prototype._toFieldTransform=function(t){var e=Jf(this,t,!0),n=this.Kc.map((function(t){return sp(t,e)})),r=new es(n);return new ss(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Bf),np=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return n(e,t),e.prototype._toFieldTransform=function(t){var e=new rs(t.R,Qo(t.R,this.jc));return new ss(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Bf);function rp(t,e,n,r){var i=t.Qc(1,e,n);cp("Data must be an object, but it was:",i,r);var o=[],s=io.empty();Si(r,(function(t,r){var a=fp(e,t,n);r=_(r);var u=i.Mc(a);if(r instanceof Xf)o.push(a);else{var c=sp(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Ri(o);return new zf(s,a,i.fieldTransforms)}function ip(t,e,n,r,i,o){var s=t.Qc(1,e,n),a=[hp(e,r,n)],u=[i];if(o.length%2!=0)throw new ai(si.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(hp(e,o[c])),u.push(o[c+1]);for(var h=[],l=io.empty(),f=a.length-1;f>=0;--f)if(!dp(h,a[f])){var p=a[f],d=u[f];d=_(d);var y=s.Mc(p);if(d instanceof Xf)h.push(p);else{var v=sp(d,y);null!=v&&(h.push(p),l.set(p,v))}}var m=new Ri(h);return new zf(l,m,s.fieldTransforms)}function op(t,e,n,r){return void 0===r&&(r=!1),sp(n,t.Qc(r?4:3,e))}function sp(t,e){if(up(t=_(t)))return cp("Unsupported field value:",e,t),ap(t,e);if(t instanceof Bf)return function(t,e){if(!Hf(e.xc))throw e.Bc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Bc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.$c&&4!==e.xc)throw e.Bc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=sp(o[i],e.Lc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=_(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Qo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=_i.fromDate(t);return{timestampValue:ea(e.R,n)}}if(t instanceof _i)return n=new _i(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ea(e.R,n)};if(t instanceof jf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qf)return{bytesValue:na(e.R,t._byteString)};if(t instanceof Sf){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Bc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:oa(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Bc("Unsupported field value: "+wf(t))}(t,e)}function ap(t,e){var n={};return Ai(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Si(t,(function(t,r){var i=sp(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function up(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof _i||t instanceof jf||t instanceof qf||t instanceof Sf||t instanceof Bf)}function cp(t,e,n){if(!up(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=wf(n);throw"an object"===r?e.Bc(t+" a custom object"):e.Bc(t+" "+r)}}function hp(t,e,n){if((e=_(e))instanceof Uf)return e._internalPath;if("string"==typeof e)return fp(t,e);throw pp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var lp=new RegExp("[~\\*/\\[\\]]");function fp(t,e,n){if(e.search(lp)>=0)throw pp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Uf.bind.apply(Uf,u([void 0],e.split(".")))))._internalPath}catch(r){throw pp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function pp(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new ai(si.INVALID_ARGUMENT,(a+=". ")+t+u)}function dp(t,e){return t.some((function(t){return t.isEqual(e)}))}var yp=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Sf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new vp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(mp("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(yp);function mp(t,e){return"string"==typeof e?fp(t,e):e instanceof Uf?e._internalPath:e._delegate._internalPath}var gp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),bp=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return n(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new wp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(mp("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(yp),wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(bp),Ip=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new gp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new wp(n._firestore,n._userDataWriter,r.key,r,new gp(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ai(si.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new wp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new gp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new wp(t._firestore,t._userDataWriter,e.doc.key,e.doc,new gp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:_p(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function _p(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return di()}}function Ep(t,e){return t instanceof bp&&e instanceof bp?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ip&&e instanceof Ip&&t._firestore===e._firestore&&Rf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Tp(t){if(xo(t)&&0===t.explicitOrderBy.length)throw new ai(si.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sp=function(){};function Ap(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Np=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wc=e,i.Gc=n,i.zc=r,i.type="where",i}return n(e,t),e.prototype._apply=function(t){var e=Yf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Lp(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(Op(r,t,l))}a={arrayValue:{values:u}}}else a=Op(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Lp(s,o),a=op(n,"where",s,"in"===o||"not-in"===o);var f=fo.create(i,o,a);return function(t,e){if(e.g()){var n=Lo(t);if(null!==n&&!n.isEqual(e.field))throw new ai(si.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Oo(t);null!==r&&Pp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new ai(si.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ai(si.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Wc,this.Gc,this.zc);return new Af(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Do(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Sp),Dp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wc=e,r.Hc=n,r.type="orderBy",r}return n(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new ai(si.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ai(si.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new To(e,n);return function(t,e){if(null===Oo(t)){var n=Lo(t);null!==n&&Pp(0,n,e.field)}}(t,r),r}(t._query,this.Wc,this.Hc);return new Af(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Do(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Sp),Cp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return n(e,t),e.prototype._apply=function(t){return new Af(t.firestore,t.converter,Vo(t._query,this.Jc,this.Yc))},e}(Sp),kp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return n(e,t),e.prototype._apply=function(t){var e=xp(t,this.type,this.Xc,this.Zc);return new Af(t.firestore,t.converter,function(t,e){return new Do(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Sp),Rp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return n(e,t),e.prototype._apply=function(t){var e=xp(t,this.type,this.Xc,this.Zc);return new Af(t.firestore,t.converter,function(t,e){return new Do(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Sp);function xp(t,e,n,r){if(n[0]=_(n[0]),n[0]instanceof yp)return function(t,e,n,r,i){if(!r)throw new ai(si.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Mo(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Xi(e,r.key));else{var c=r.data.field(u.field);if(Fi(c))throw new ai(si.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new ai(si.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new _o(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Yf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new ai(si.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new ai(si.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Po(t)&&-1!==c.indexOf("/"))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Di.fromString(c));if(!Ki.isDocumentKey(h))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ki(h);a.push(Xi(e,l))}else{var f=op(n,r,c);a.push(f)}}return new _o(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Op(t,e,n){if("string"==typeof(n=_(n))){if(""===n)throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Po(e)&&-1!==n.indexOf("/"))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Di.fromString(n));if(!Ki.isDocumentKey(r))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Xi(t,new Ki(r))}if(n instanceof Sf)return Xi(t,n._key);throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+wf(n)+".")}function Lp(t,e){if(!Array.isArray(t)||0===t.length)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Pp(t,e,n){if(!n.isEqual(e))throw new ai(si.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Mp=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Gi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Pi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Mi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw di()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Si(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new jf(Pi(t.latitude),Pi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Vi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ui(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Li(t);return new _i(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Di.fromString(t);yi(ka(n));var r=new af(n.get(1),n.get(3)),i=new Ki(n.popFirst(5));return r.isEqual(e)||li("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function Fp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Vp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.convertBytes=function(t){return new qf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Sf(this.firestore,null,e)},e}(Mp),Up=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Yf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=qp(t,this._firestore),i=Fp(r.converter,e,n),o=$f(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,us.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=qp(t,this._firestore);return o="string"==typeof(e=_(e))||e instanceof Uf?ip(this._dataReader,"WriteBatch.update",s._key,e,n,r):rp(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,us.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=qp(t,this._firestore);return this._mutations=this._mutations.concat(new Es(e._key,us.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new ai(si.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function qp(t,e){if((t=_(t)).firestore!==e)throw new ai(si.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Bp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.convertBytes=function(t){return new qf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Sf(this.firestore,null,e)},e}(Mp);function jp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=If(t,Sf);var o=If(t.firestore,Lf),s=Yf(o);return Gp(o,[("string"==typeof(e=_(e))||e instanceof Uf?ip(s,"updateDoc",t._key,e,n,r):rp(s,"updateDoc",t._key,e)).toMutation(t._key,us.exists(!0))])}function Kp(t){for(var e,n,r,s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];t=_(t);var u={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||Of(s[c])||(u=s[c],c++);var h,l,f,p={includeMetadataChanges:u.includeMetadataChanges};if(Of(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Sf)l=If(t.firestore,Lf),f=ko(t._key.path),h={next:function(e){s[c]&&s[c](zp(l,t,e))},error:s[c+1],complete:s[c+2]};else{var y=If(t,Af);l=If(y.firestore,Lf),f=y._query;var v=new Bp(l);h={next:function(t){s[c]&&s[c](new Ip(l,v,y,t))},error:s[c+1],complete:s[c+2]},Tp(t._query)}return function(t,e,n,r){var s=this,a=new Gl(r),u=new tl(e,a,n);return t.asyncQueue.enqueueAndForget((function(){return i(s,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=Yh,[4,nf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){a.Wo(),t.asyncQueue.enqueueAndForget((function(){return i(s,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=$h,[4,nf(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Pf(l),f,p,h)}function Gp(t,e){return function(t,e){var n=this,r=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return n=fl,[4,ef(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Pf(t),e)}function zp(t,e,n){var r=n.docs.get(e._key),i=new Bp(t);return new bp(t,i,e._key,r,new gp(n.hasPendingWrites,n.fromCache),e.converter)}var Hp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return n(e,t),e.prototype.get=function(e){var n=this,r=qp(e,this._firestore),i=new Bp(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new bp(n._firestore,i,r._key,t._document,new gp(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Yf(t)}return t.prototype.get=function(t){var e=this,n=qp(t,this._firestore),r=new Vp(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return di();var i=t[0];if(i.isFoundDocument())return new yp(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new yp(e._firestore,r,n._key,null,n.converter);throw di()}))},t.prototype.set=function(t,e,n){var r=qp(t,this._firestore),i=Fp(r.converter,e,n),o=$f(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=qp(t,this._firestore);return o="string"==typeof(e=_(e))||e instanceof Uf?ip(this._dataReader,"Transaction.update",s._key,e,n,r):rp(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=qp(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Qp(){if("undefined"==typeof Uint8Array)throw new ai(si.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wp(){if("undefined"==typeof atob)throw new ai(si.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Yp=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Wp(),new t(qf.fromBase64String(e))},t.fromUint8Array=function(e){return Qp(),new t(qf.fromUint8Array(e))},t.prototype.toBase64=function(){return Wp(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Qp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),$p=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Vf(t=If(t,Lf));var n=Pf(t),r=t._freezeSettings(),i=new Kl;return Ff(n,i,new Bl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Vf(t=If(t,Lf));var e=Pf(t),n=t._freezeSettings(),r=new Kl;return Ff(e,r,new jl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new ai(si.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new tu;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return ru.yt()?(e=t+"main",[4,ru.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(dc(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Xp=function(){function t(t,e,n){var r=this;this._delegate=e,this.tu=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof af||(this.eu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||fi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,i){void 0===i&&(i={});var o=(t=If(t,Tf))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&fi("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),i.mockUserToken){var s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n="demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=r({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[c.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),c.encodeString(JSON.stringify(s),!1),""].join(".")}(i.mockUserToken),a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new ai(si.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new lf(new cf(s,new zc(a)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return i(e,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,Jl(t)];case 1:return e=r.sent(),[4,tf(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=vi(t);return e.Or.delete(0),mh(e)}(n))]}}))}))}))}(Pf(If(this._delegate,Lf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return i(e,void 0,void 0,(function(){var e,n;return o(this,(function(r){switch(r.label){case 0:return[4,Jl(t)];case 1:return e=r.sent(),[4,tf(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return(e=vi(t)).Or.add(0),[4,gh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Pf(If(this._delegate,Lf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&mf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.tu.enableMultiTabIndexedDbPersistence(this):this.tu.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.tu.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.eu&&(this.eu._removeServiceInstance("firestore"),this.eu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return e=gl,[4,ef(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Pf(If(this._delegate,Lf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Gl(e);return t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=function(t,e){vi(t).Gr.add(e),e.next()},[4,nf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=function(t,e){vi(t).Gr.delete(e)},[4,nf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Pf(t=If(t,Lf)),Of(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.eu)throw new ai(si.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.eu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new ld(this,Df(this._delegate,t))}catch(t){throw rd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new nd(this,Cf(this._delegate,t))}catch(t){throw rd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new ud(this,function(t,e){if(t=If(t,Tf),yf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ai(si.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Af(t,null,function(t){return new Do(Di.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw rd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return[4,function(t){return Xl(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Hl(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Pf(t),(function(n){return e(new Hp(t,n))}))}(this._delegate,(function(n){return t(new Zp(e,n))}))},t.prototype.batch=function(){var t=this;return Pf(this._delegate),new td(new Up(this._delegate,(function(e){return Gp(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new ai(si.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new ai(si.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Jp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return n(e,t),e.prototype.convertBytes=function(t){return new Yp(new qf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return nd.nu(e,this.firestore,null)},e}(Mp),Zp=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Jp(t)}return t.prototype.get=function(t){var e=this,n=fd(t);return this._delegate.get(n).then((function(t){return new sd(e._firestore,new bp(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=fd(t);return n?(vf("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=fd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,u([s,e,n],i)),this},t.prototype.delete=function(t){var e=fd(t);return this._delegate.delete(e),this},t}(),td=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=fd(t);return n?(vf("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=fd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,u([s,e,n],i)),this},t.prototype.delete=function(t){var e=fd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),ed=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new wp(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ad(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.su=function(e,n){var r=t.iu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Jp(e),n),i.set(n,o)),o},t}();ed.iu=new WeakMap;var nd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Jp(t)}return t.ru=function(e,n,r){if(e.length%2!=0)throw new ai(si.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Sf(n._delegate,r,new Ki(e)))},t.nu=function(e,n,r){return new t(n,new Sf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ld(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new ld(this.firestore,Df(this._delegate,t))}catch(t){throw rd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=_(t))instanceof Sf&&kf(this._delegate,t)},t.prototype.set=function(t,e){e=vf("DocumentReference.set",e);try{return function(t,e,n){t=If(t,Sf);var r=If(t.firestore,Lf),i=Fp(t.converter,e,n);return Gp(r,[$f(Yf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,us.none())])}(this._delegate,t,e)}catch(t){throw rd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?jp(this._delegate,t):jp.apply(void 0,u([this._delegate,t,e],n))}catch(t){throw rd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Gp(If((t=this._delegate).firestore,Lf),[new Es(t._key,us.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=id(e),i=od(e,(function(e){return new sd(t.firestore,new bp(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Kp(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=If(t,Sf);var e=If(t.firestore,Lf),n=Pf(e),r=new Bp(e);return function(t,e){var n=this,r=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=vi(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new ai(si.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Kh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Zl(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new bp(e,r,t._key,n,new gp(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=If(t,Sf);var e=If(t.firestore,Lf);return rf(Pf(e),t._key,{source:"server"}).then((function(n){return zp(e,t,n)}))}(this._delegate):function(t){t=If(t,Sf);var e=If(t.firestore,Lf);return rf(Pf(e),t._key).then((function(n){return zp(e,t,n)}))}(this._delegate)).then((function(t){return new sd(e.firestore,new bp(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ed.su(this.firestore,e)):this._delegate.withConverter(null))},t}();function rd(t,e,n){return t.message=t.message.replace(e,n),t}function id(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Of(r))return r}return{}}function od(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Of(t[0])?t[0]:Of(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var sd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new nd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Ep(this._delegate,t._delegate)},t}(),ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(sd),ud=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Jp(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Ap(this._delegate,function(t,e,n){var r=e,i=mp("where",t);return new Np(i,r,n)}(e,n,r)))}catch(e){throw rd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Ap(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=mp("orderBy",t);return new Dp(r,n)}(e,n)))}catch(e){throw rd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Ap(this._delegate,function(t){return _f("limit",t),new Cp("limit",t,"F")}(e)))}catch(e){throw rd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Ap(this._delegate,function(t){return _f("limitToLast",t),new Cp("limitToLast",t,"L")}(e)))}catch(e){throw rd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw rd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw rd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rp("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw rd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Ap(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rp("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw rd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Rf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=If(t,Af);var e=If(t.firestore,Lf),n=Pf(e),r=new Bp(e);return function(t,e){var n=this,r=new tu;return t.asyncQueue.enqueueAndForget((function(){return i(n,void 0,void 0,(function(){var n;return o(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return i(this,void 0,void 0,(function(){var r,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Cc(t,e,!0)];case 1:return u=o.sent(),r=new ol(e,u.Bn),i=r._o(u.documents),s=r.applyChanges(i,!1),n.resolve(s.snapshot),[3,3];case 2:return a=o.sent(),u=Kh(a,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,Zl(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Ip(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=If(t,Af);var e=If(t.firestore,Lf),n=Pf(e),r=new Bp(e);return of(n,t._query,{source:"server"}).then((function(n){return new Ip(e,r,t,n)}))}(this._delegate):function(t){t=If(t,Af);var e=If(t.firestore,Lf),n=Pf(e),r=new Bp(e);return Tp(t._query),of(n,t._query).then((function(n){return new Ip(e,r,t,n)}))}(this._delegate)).then((function(t){return new hd(e.firestore,new Ip(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=id(e),i=od(e,(function(e){return new hd(t.firestore,new Ip(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Kp(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ed.su(this.firestore,e)):this._delegate.withConverter(null))},t}(),cd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new ad(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),hd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new ud(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new ad(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new cd(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new ad(n._firestore,r))}))},t.prototype.isEqual=function(t){return Ep(this._delegate,t._delegate)},t}(),ld=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return n(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new nd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new nd(this.firestore,void 0===t?Cf(this._delegate):Cf(this._delegate,t))}catch(t){throw rd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=If(t.firestore,Lf),r=Cf(t),i=Fp(t.converter,e);return Gp(n,[$f(Yf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,us.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new nd(e.firestore,t)}))},e.prototype.isEqual=function(t){return kf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(ed.su(this.firestore,t)):this._delegate.withConverter(null))},e}(ud);function fd(t){return If(t,Sf)}var pd,dd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Uf.bind.apply(Uf,u([void 0],t)))}return t.documentId=function(){return new t(ki.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=_(t))instanceof Uf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),yd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Zf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Xf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tp("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ep("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new np("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),vd={Firestore:Xp,GeoPoint:jf,Timestamp:_i,Blob:Yp,Transaction:Zp,WriteBatch:td,DocumentReference:nd,DocumentSnapshot:sd,Query:ud,QueryDocumentSnapshot:ad,QuerySnapshot:hd,CollectionReference:ld,FieldPath:dd,FieldValue:yd,setLogLevel:function(t){var e;e=t,ui.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new T("firestore",(function(t){return function(t,e){return new Xp(t,new Lf(t,e),new $p)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},vd)))})(pd=J),pd.registerVersion("@firebase/firestore","2.3.2");var md={apiKey:"MISSING_ENV_VAR".FIREBASE_API_KEY,authDomain:"MISSING_ENV_VAR".FIREBASE_AUTH_DOMAIN,projectId:"MISSING_ENV_VAR".FIREBASE_PROJECT_ID,storageBucket:"MISSING_ENV_VAR".FIREBASE_STORAGE_BUCKET,messagingSenderId:"MISSING_ENV_VAR".FIREBASE_MESSAGING_SENDER_ID,appId:"MISSING_ENV_VAR".FIREBASE_APP_ID,measurementId:"MISSING_ENV_VAR".FIREBASE_MEASUREMENT_ID};J.initializeApp(md).firestore(),$(".cta__form");var gd=$("#modal"),bd=($(".nav"),$('a[href*="#"]'));(t=>{for(var e=$("#project-list"),n=0;n<t.length;n++){var r='\n    <article class="project">\n    <div class="project__picture">\n      <div class="project__backdrop" style="--background-image: url(../'.concat(t[n].photo,')"></div>\n\n      <img src=').concat(t[n].photo,' alt="project image" class="project__img">\n    </div>\n    <div class="project__content">\n      <h2 class="heading-2 heading-2--dark mb-md">&ldquo;').concat(t[n].title,'&rdquo;</h2>\n\n      <p class="project__text">\n      ').concat(t[n].description,'\n      </p>\n      <div class="btn__group">\n        <a class="btn" href=').concat(t[n].demoLink,' style="').concat(t[n].demoLink?"display: inline-block;":"display: none",'" target="_blank">live Demo</a>\n        <a class="btn" href=').concat(t[n].repoLink,' style="').concat(t[n].repoLink?"display: inline-block;":"display: none",'" target="_blank" >Github Repo</a>\n      </div>\n    </div>\n  </article>\n  ');e.append(r)}})([{title:"Track That Job",description:"This is a demo app created to keep myself organized, while job searching. I created this application myself from end to end, using React / Redux, CSS / Sass, Mongodb, Express. Hosted on Heroku",repoLink:"https://github.com/ADamian17/job_tracker",demoLink:"http://www.trackthatjob.com",photo:"./images/trackThatJob.png"},{title:"Electron Chat App",description:"This is a native demo app, created using Electron React/Redux and Firebase.",repoLink:"https://github.com/ADamian17/electron-app",demoLink:"https://adamian17.github.io/static-e/",photo:"./images/chatapp.png"},{title:"WatchChulo",description:"This is a demo app  inspired by Hulu. I built this app myself from start to finish, using Mongodb, Express, React, Node and Bootstrap. Hosted on Heroku",repoLink:"https://github.com/ADamian17/chulo-front-end",demoLink:"https://watchchulo.herokuapp.com",photo:"./images/chulo2.png"},{title:"Burning Rubber",description:"This is my first project that I created. I used css animations to bring it to live, is very fun and easy game to play. Built with html/css, Javascript, and jQuery",repoLink:"https://git.generalassemb.ly/ADamian17/burnning_rubber",demoLink:"https://burningrubber.netlify.app/",photo:"./images/burnining_ruber_new.png"}]),$(document).scroll((()=>{$(document).scrollTop()>=100?$(".back-to-the-top").css({visibility:"visible","pointer-events":"all"}):$(".back-to-the-top").css({visibility:"hidden","pointer-events":"none"})})),gd.on("click",(function(t){gd.css({display:"none"})})),bd.not('[href="#"]').not('[href="#0"]').click((function(t){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);(e=e.length?e:$("[name="+this.hash.slice(1)+"]")).length&&(t.preventDefault(),$("html, body").animate({scrollTop:e.offset().top},1e3,(function(){var t=$(e);if(t.focus(),t.is(":focus"))return!1;t.attr("tabindex","-1"),t.focus()})))}}))})();
//# sourceMappingURL=app.js.map